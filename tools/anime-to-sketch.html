<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- å¯¼èˆªæ å’Œé¡µè„šç»„ä»¶ -->
    <script src="../components/navbar.js"></script>
    <script src="../components/footer.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…· - å°è·¯å·¥å…·ç®±</title>
    <meta name="description" content="å…è´¹åœ¨çº¿åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…·ï¼Œæ”¯æŒJPGã€PNGç­‰æ ¼å¼ï¼Œä¸€é”®ç”Ÿæˆäººç‰©è½®å»“çº¿ç¨¿ï¼Œé€‚åˆå„¿ç«¥æ¶‚è‰²ä½¿ç”¨ï¼Œç®€æ´æ˜“ç”¨çš„ç•Œé¢è®¾è®¡">
    <meta name="keywords" content="åŠ¨æ¼«è½¬çº¿ç¨¿,å›¾ç‰‡è½¬é“…ç¬”ç”»,çº¿ç¨¿ç”Ÿæˆå™¨,æ¶‚è‰²çº¿ç¨¿,åŠ¨æ¼«çº¿ç¨¿,å…è´¹çº¿ç¨¿å·¥å…·,åœ¨çº¿å›¾ç‰‡å¤„ç†">
    <meta name="author" content="å°è·¯å·¥å…·ç®±">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tools.xiaolu.page/tools/anime-to-sketch.html">
    <meta property="og:title" content="åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…· - å°è·¯å·¥å…·ç®±">
    <meta property="og:description" content="å…è´¹åœ¨çº¿åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…·ï¼Œæ”¯æŒJPGã€PNGç­‰æ ¼å¼ï¼Œä¸€é”®ç”Ÿæˆäººç‰©è½®å»“çº¿ç¨¿ï¼Œé€‚åˆå„¿ç«¥æ¶‚è‰²ä½¿ç”¨">
    <meta property="og:image" content="https://tools.xiaolu.page/images/anime-to-sketch-preview.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tools.xiaolu.page/tools/anime-to-sketch.html">
    <meta property="twitter:title" content="åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…· - å°è·¯å·¥å…·ç®±">
    <meta property="twitter:description" content="å…è´¹åœ¨çº¿åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…·ï¼Œæ”¯æŒJPGã€PNGç­‰æ ¼å¼ï¼Œä¸€é”®ç”Ÿæˆäººç‰©è½®å»“çº¿ç¨¿ï¼Œé€‚åˆå„¿ç«¥æ¶‚è‰²ä½¿ç”¨">
    <meta property="twitter:image" content="https://tools.xiaolu.page/images/anime-to-sketch-preview.jpg">
    
    <!-- ç»“æ„åŒ–æ•°æ® -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…·",
        "description": "å…è´¹åœ¨çº¿åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿å·¥å…·ï¼Œæ”¯æŒJPGã€PNGç­‰æ ¼å¼ï¼Œä¸€é”®ç”Ÿæˆäººç‰©è½®å»“çº¿ç¨¿ï¼Œé€‚åˆå„¿ç«¥æ¶‚è‰²ä½¿ç”¨",
        "url": "https://tools.xiaolu.page/tools/anime-to-sketch.html",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CNY"
        }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        /* å¯¼èˆªæ æ ·å¼ç”±ç»„ä»¶æä¾› */
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* å¯¼èˆªæ æ ·å¼ç”±ç»„ä»¶æä¾› */
        
        /* å¯¼èˆªæ æ ·å¼ç”±ç»„ä»¶æä¾› */
        
        /* å¯¼èˆªæ æ ·å¼ç”±ç»„ä»¶æä¾› */
        
        /* å¯¼èˆªæ æ ·å¼ç”±ç»„ä»¶æä¾› */
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .tool-header {
            text-align: center;
            margin: 0 auto 3rem auto;
            padding: 2rem 0;
            max-width: 800px;
        }
        
        .tool-header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .tool-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 1.5rem auto;
        }
        
        .tool-features {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        
        .feature-tag {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .step-content h4 {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .step-content p {
            color: #666;
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        .main-content {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 0 auto 2rem auto;
            flex: 1;
            max-width: 1200px;
        }
        
        .content-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: start;
        }
        
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            min-height: 500px;
        }
        
        .right-panel {
            min-height: 500px;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        .upload-area {
            border: 3px dashed #007AFF;
            border-radius: 15px;
            padding: 3rem;
            text-align: center;
            background: #f8f9ff;
            transition: all 0.3s ease;
            margin-bottom: 2rem;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: #0056b3;
            background: #f0f4ff;
        }
        
        .upload-area.dragover {
            border-color: #28a745;
            background: #f0fff4;
        }
        
        .upload-icon {
            font-size: 4rem;
            color: #007AFF;
            margin-bottom: 1rem;
        }
        
        .upload-text {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 1rem;
        }
        
        .upload-hint {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 1rem;
        }
        
        .upload-tips {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            margin-top: 1rem;
        }
        
        .tip-item {
            font-size: 0.8rem;
            color: #666;
            text-align: left;
        }
        
        .example-section {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .example-title {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .example-grid {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        
        .example-item {
            text-align: center;
            flex: 1;
        }
        
        .example-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .example-placeholder {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .example-arrow {
            font-size: 1.5rem;
            color: #007AFF;
            font-weight: bold;
        }
        
        .file-input {
            display: none;
        }
        
        .preview-container {
            display: none;
            margin-top: 2rem;
            flex: 1;
            overflow-y: auto;
            max-height: 600px;
        }
        
        .image-list {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            padding-right: 1rem;
        }
        
        .image-item {
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 1.5rem;
            background: #fafafa;
        }
        
        .image-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .image-item-title {
            font-weight: 600;
            color: #333;
            font-size: 1.1rem;
        }
        
        .image-item-status {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-processing {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .preview-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .preview-item {
            text-align: center;
        }
        
        .preview-item h4 {
            margin-bottom: 0.8rem;
            color: #555;
            font-size: 1rem;
        }
        
        .preview-image {
            width: 100%;
            max-height: 250px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            object-fit: contain;
            background: #f8f9fa;
        }
        
        .image-actions {
            margin-top: 1rem;
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            border-radius: 6px;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            text-align: center;
            width: 100%;
        }
        
        .btn-primary {
            background: #007AFF;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #1e7e34;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-container {
            display: none;
            margin: 2rem 0;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007AFF, #0056b3);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            color: #666;
            font-size: 0.9rem;
        }
        
        .settings-panel {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 2rem;
        }
        
        .settings-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #333;
            text-align: center;
        }
        
        .setting-group {
            margin-bottom: 1rem;
        }
        
        .setting-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #555;
        }
        
        .setting-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .preset-btn {
            padding: 0.6rem 1rem;
            border: 2px solid #007AFF;
            background: white;
            color: #007AFF;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .preset-btn:hover {
            background: #007AFF;
            color: white;
            transform: translateY(-1px);
        }
        
        .preset-btn.active {
            background: #007AFF;
            color: white;
        }
        
        .setting-label span {
            color: #007AFF;
            font-weight: 600;
        }
        
        .info-section {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .info-section h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        
        .info-section h3 {
            color: #007AFF;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }
        
        .info-section p, .info-section li {
            color: #666;
            margin-bottom: 0.8rem;
        }
        
        .info-section ul {
            padding-left: 1.5rem;
        }
        
        .tips-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 3rem;
            margin: 2rem auto;
            max-width: 1200px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            color: white;
        }
        
        .tips-section h2 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 2.5rem;
            font-weight: 600;
            color: white;
        }
        
        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .tip-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .tip-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        
        .tip-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .tip-card h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: white;
        }
        
        .tip-card p {
            line-height: 1.6;
            font-size: 0.9rem;
            opacity: 0.9;
            color: white;
        }
        
        .final-note {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            margin-top: 2rem;
        }
        
        .final-note p {
            margin: 0;
            font-size: 1rem;
            line-height: 1.6;
            color: white;
        }
        
        .final-note strong {
            color: #FFD700;
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 2rem 0;
            text-align: center;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: #666;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: #007AFF;
        }
        
        .footer-text {
            color: #999;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            /* å¯¼èˆªæ æ ·å¼ç”±ç»„ä»¶æä¾› */
            
            .container {
                padding: 1rem;
            }
            
            .main-content {
                padding: 2rem 1.5rem;
            }
            
            .content-layout {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .settings-panel {
                position: static;
                margin-bottom: 2rem;
            }
            
            .preview-container {
                max-height: none;
                overflow: visible;
            }
            
            .tool-header h1 {
                font-size: 2rem;
            }
            
            .preview-grid {
                grid-template-columns: 1fr;
            }
            
            .image-item {
                padding: 1rem;
            }
            
            .image-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
            
            .tool-features {
                gap: 0.5rem;
            }
            
            .feature-tag {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            .preset-buttons {
                grid-template-columns: 1fr;
                gap: 0.3rem;
            }
            
            .preset-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .example-grid {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .example-arrow {
                transform: rotate(90deg);
            }
            
            .upload-tips {
                gap: 0.2rem;
            }
            
            .tip-item {
                font-size: 0.75rem;
            }
            

        }
    </style>

    <!-- å¯¼èˆªæ å’Œé¡µè„šç»„ä»¶ -->
    <script src="../components/navbar.js"></script>
    <script src="../components/footer.js"></script>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    
    <!-- å¯¼èˆªæ å°†é€šè¿‡JavaScriptç»„ä»¶è‡ªåŠ¨ç”Ÿæˆ -->

    <div class="container">
        <!-- å·¥å…·æ ‡é¢˜ -->
        <div class="tool-header">
            <h1>ğŸ¨ åŠ¨æ¼«å›¾ç‰‡è½¬é“…ç¬”çº¿ç¨¿</h1>
            <p>å°†åŠ¨æ¼«å›¾ç‰‡ä¸€é”®è½¬æ¢ä¸ºç²¾ç¾çº¿ç¨¿ï¼Œæ”¯æŒæ‰¹é‡å¤„ç†ï¼Œå®Œå…¨å…è´¹ä½¿ç”¨</p>
            
            <div class="tool-features">
                <span class="feature-tag">âœ¨ å®æ—¶é¢„è§ˆ</span>
                <span class="feature-tag">ğŸš€ æ‰¹é‡å¤„ç†</span>
                <span class="feature-tag">ğŸ¯ æ™ºèƒ½ä¼˜åŒ–</span>
                <span class="feature-tag">ğŸ“± ç§»åŠ¨å‹å¥½</span>
            </div>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <div class="main-content">
            <div class="content-layout">
                <!-- å·¦ä¾§é¢æ¿ -->
                <div class="left-panel">
                    <!-- ä¸Šä¼ åŒºåŸŸ -->
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">ğŸ“¸</div>
                        <div class="upload-text">æ‹–æ‹½åŠ¨æ¼«å›¾ç‰‡åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</div>
                        <div class="upload-hint">æ”¯æŒ JPGã€PNGã€GIFã€BMPã€WEBP ç­‰æ ¼å¼ï¼Œå¯åŒæ—¶é€‰æ‹©å¤šå¼ å›¾ç‰‡</div>
                        <div class="upload-tips">
                            <div class="tip-item">ğŸ’¡ å»ºè®®ä½¿ç”¨æ¸…æ™°çš„åŠ¨æ¼«äººç‰©å›¾ç‰‡</div>
                            <div class="tip-item">ğŸ“ æ¨èåˆ†è¾¨ç‡ï¼š500x500 - 2000x2000</div>
                            <div class="tip-item">ğŸ“¦ æ–‡ä»¶å¤§å°ï¼šä¸è¶…è¿‡ 10MB</div>
                        </div>
                        <input type="file" id="fileInput" class="file-input" accept="image/*" multiple>
                    </div>
                    
                    <!-- ç¤ºä¾‹å›¾ç‰‡ -->
                    <div class="example-section">
                        <div class="example-title">ğŸ“– æ•ˆæœç¤ºä¾‹</div>
                        <div class="example-grid">
                            <div class="example-item">
                                <div class="example-label">åŸå›¾</div>
                                <div class="example-placeholder">ğŸ­</div>
                            </div>
                            <div class="example-arrow">â†’</div>
                            <div class="example-item">
                                <div class="example-label">çº¿ç¨¿</div>
                                <div class="example-placeholder">âœï¸</div>
                            </div>
                        </div>
                    </div>

                    <!-- é¢„è§ˆåŒºåŸŸ -->
                    <div class="preview-container" id="previewContainer">
                        <div id="imageList" class="image-list"></div>
                    </div>
                </div>

                <!-- å³ä¾§é¢æ¿ -->
                <div class="right-panel">
                    <!-- è®¾ç½®é¢æ¿ -->
                    <div class="settings-panel">
                        <div class="settings-title">çº¿ç¨¿è®¾ç½®</div>
                        
                        <!-- é¢„ç½®æ¨¡æ¿ -->
                        <div class="setting-group">
                            <label class="setting-label">å¿«é€Ÿé¢„è®¾</label>
                            <div class="preset-buttons">
                                <button class="preset-btn" data-preset="fine">ç²¾ç»†çº¿ç¨¿</button>
                                <button class="preset-btn" data-preset="bold">ç²—çº¿æ¡</button>
                                <button class="preset-btn" data-preset="soft">æŸ”å’Œé£æ ¼</button>
                                <button class="preset-btn" data-preset="sketch">æ‰‹ç»˜é£æ ¼</button>
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">è¾¹ç¼˜æ£€æµ‹å¼ºåº¦ <span id="edgeValue">100</span></label>
                            <input type="range" id="edgeStrength" class="setting-input" min="50" max="200" value="100">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">çº¿æ¡ç²—ç»† <span id="thicknessValue">2</span></label>
                            <input type="range" id="lineThickness" class="setting-input" min="1" max="5" value="2">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">å¯¹æ¯”åº¦ <span id="contrastValue">100</span></label>
                            <input type="range" id="contrast" class="setting-input" min="50" max="150" value="100">
                        </div>
                    </div>

                    <!-- æ§åˆ¶æŒ‰é’® -->
                    <div class="controls">
                        <button id="generateBtn" class="btn btn-primary">æ‰¹é‡ç”Ÿæˆçº¿ç¨¿</button>
                        <button id="downloadBtn" class="btn btn-success" disabled>ä¸‹è½½æ‰€æœ‰çº¿ç¨¿</button>
                        <button id="resetBtn" class="btn btn-secondary">é‡æ–°é€‰æ‹©</button>
                    </div>

                    <!-- è¿›åº¦æ¡ -->
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">å¤„ç†ä¸­...</div>
                    </div>
                </div>
            </div>
        </div>



        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="info-section">
            <h2>ğŸ“– ä½¿ç”¨è¯´æ˜</h2>
            
            <h3>ä½¿ç”¨æ­¥éª¤</h3>
            <p><strong>1. ä¸Šä¼ å›¾ç‰‡</strong> â†’ ç‚¹å‡»ä¸Šä¼ åŒºåŸŸæˆ–æ‹–æ‹½å›¾ç‰‡ï¼Œæ”¯æŒJPGã€PNGã€GIFç­‰æ ¼å¼</p>
            <p><strong>2. è°ƒæ•´å‚æ•°</strong> â†’ ä½¿ç”¨é¢„è®¾æ¨¡æ¿æˆ–æ‰‹åŠ¨è°ƒæ•´è¾¹ç¼˜å¼ºåº¦ã€çº¿æ¡ç²—ç»†ã€å¯¹æ¯”åº¦</p>
            <p><strong>3. ç”Ÿæˆä¸‹è½½</strong> â†’ ç‚¹å‡»ç”ŸæˆæŒ‰é’®å¤„ç†å›¾ç‰‡ï¼Œå®Œæˆåä¸‹è½½çº¿ç¨¿</p>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <p><strong>ğŸ¨ å„¿ç«¥æ¶‚è‰²</strong> - åˆ¶ä½œä¸“å±æ¶‚è‰²ç´ æ | <strong>ğŸ“š ç¾æœ¯æ•™å­¦</strong> - å¿«é€Ÿåˆ¶ä½œæ•™æ | <strong>ğŸ’¡ è®¾è®¡å‚è€ƒ</strong> - æå–è½®å»“ç»“æ„ | <strong>ğŸ­ åŒäººåˆ›ä½œ</strong> - çº¿ç¨¿åŸºç¡€ç´ æ</p>
            
            <h3>ä½¿ç”¨æŠ€å·§</h3>
            <p>é€‰æ‹©è½®å»“æ¸…æ™°çš„åŠ¨æ¼«äººç‰©å›¾ç‰‡æ•ˆæœæœ€ä½³ï¼Œå»ºè®®åˆ†è¾¨ç‡500-2000åƒç´ ï¼Œå¯å¤šæ¬¡è°ƒæ•´å‚æ•°è·å¾—æ»¡æ„æ•ˆæœã€‚æ‰€æœ‰å¤„ç†åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä¿æŠ¤éšç§å®‰å…¨ã€‚</p>
        </div>

        <!-- å¸¸è§é—®é¢˜ -->
        <div class="info-section">
            <h2>â“ å¸¸è§é—®é¢˜</h2>
            
            <h3>Q: æ”¯æŒå“ªäº›å›¾ç‰‡æ ¼å¼ï¼Ÿ</h3>
            <p>A: æ”¯æŒ JPGã€PNGã€GIFã€BMPã€WEBP ç­‰å¸¸è§å›¾ç‰‡æ ¼å¼ï¼Œæ¨èä½¿ç”¨ PNG æˆ– JPG æ ¼å¼ä»¥è·å¾—æœ€ä½³æ•ˆæœã€‚</p>
            
            <h3>Q: å›¾ç‰‡å¤§å°æœ‰é™åˆ¶å—ï¼Ÿ</h3>
            <p>A: å»ºè®®ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 10MBï¼Œåˆ†è¾¨ç‡åœ¨ 500x500 åˆ° 2000x2000 åƒç´ ä¹‹é—´æ•ˆæœæœ€ä½³ã€‚</p>
            
            <h3>Q: ç”Ÿæˆçš„çº¿ç¨¿ä¸å¤Ÿæ¸…æ™°æ€ä¹ˆåŠï¼Ÿ</h3>
            <p>A: å¯ä»¥å°è¯•è°ƒæ•´"è¾¹ç¼˜æ£€æµ‹å¼ºåº¦"å‚æ•°ï¼Œå¢åŠ æ•°å€¼å¯ä»¥è·å¾—æ›´æ¸…æ™°çš„çº¿æ¡ï¼Œæˆ–è€…é€‰æ‹©å¯¹æ¯”åº¦æ›´é«˜çš„åŸå›¾ã€‚</p>
            
            <h3>Q: å¯ä»¥æ‰¹é‡å¤„ç†å›¾ç‰‡å—ï¼Ÿ</h3>
            <p>A: æ”¯æŒæ‰¹é‡å¤„ç†ï¼æ‚¨å¯ä»¥åŒæ—¶é€‰æ‹©å¤šå¼ å›¾ç‰‡ï¼Œç„¶åç‚¹å‡»"æ‰¹é‡ç”Ÿæˆçº¿ç¨¿"ä¸€æ¬¡æ€§å¤„ç†æ‰€æœ‰å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥å•ç‹¬å¤„ç†æŒ‡å®šçš„å›¾ç‰‡ã€‚</p>
            
            <h3>Q: ç”Ÿæˆçš„çº¿ç¨¿å¯ä»¥å•†ç”¨å—ï¼Ÿ</h3>
            <p>A: å·¥å…·æœ¬èº«å…è´¹ä½¿ç”¨ï¼Œä½†è¯·ç¡®ä¿åŸå›¾ç‰‡çš„ç‰ˆæƒåˆè§„ï¼Œç”Ÿæˆçš„çº¿ç¨¿ç”¨é€”éœ€éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚</p>
            
            <h3>Q: å¤„ç†é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ</h3>
            <p>A: å¤„ç†é€Ÿåº¦å–å†³äºå›¾ç‰‡å¤§å°å’Œè®¾å¤‡æ€§èƒ½ï¼Œå»ºè®®ä½¿ç”¨è¾ƒæ–°çš„æµè§ˆå™¨ï¼Œå¹¶ç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®šã€‚</p>
        </div>
        
        <!-- å·¥å…·ä¼˜åŠ¿ -->
        <div class="info-section">
            <h2>ğŸŒŸ å·¥å…·ä¼˜åŠ¿</h2>
            <p><strong>âš¡ ä¸€é”®è½¬æ¢</strong> - æ™ºèƒ½ç®—æ³•è‡ªåŠ¨è¯†åˆ«ï¼Œæ— éœ€å¤æ‚è®¾ç½® | <strong>ğŸ¨ é«˜æ¸…è¾“å‡º</strong> - ä¿æŒåŸå›¾åˆ†è¾¨ç‡ï¼Œçº¿æ¡æ¸…æ™°æµç•…</p>
            <p><strong>ğŸ”§ å‚æ•°å¯è°ƒ</strong> - å¤šç§é¢„è®¾æ¨¡æ¿ï¼Œæ”¯æŒç²¾ç»†è°ƒèŠ‚ | <strong>ğŸŒ å…å®‰è£…</strong> - æµè§ˆå™¨ç›´æ¥ä½¿ç”¨ï¼Œæ”¯æŒæ‰€æœ‰è®¾å¤‡</p>
            <p><strong>ğŸ“¦ æ‰¹é‡å¤„ç†</strong> - åŒæ—¶å¤„ç†å¤šå¼ å›¾ç‰‡ï¼Œæå‡æ•ˆç‡ | <strong>ğŸ’ å®Œå…¨å…è´¹</strong> - æ‰€æœ‰åŠŸèƒ½å…è´¹å¼€æ”¾ï¼Œæ— éšè—è´¹ç”¨</p>
        </div>

        <!-- å·¥å…·ç‰¹è‰² -->
        <div class="info-section">
            <h2>ğŸ¯ å·¥å…·ç‰¹è‰²</h2>
            <p><strong>ğŸ¨ æ™ºèƒ½çº¿ç¨¿</strong> - é‡‡ç”¨å…ˆè¿›çš„è¾¹ç¼˜æ£€æµ‹ç®—æ³•ï¼Œç²¾å‡†æå–å›¾ç‰‡è½®å»“ï¼Œç”Ÿæˆæ¸…æ™°æµç•…çš„çº¿æ¡ï¼Œå®Œç¾è¿˜åŸåŸå›¾ç»†èŠ‚</p>
            <p><strong>ğŸ› ï¸ çµæ´»è°ƒèŠ‚</strong> - æä¾›è¾¹ç¼˜å¼ºåº¦ã€çº¿æ¡ç²—ç»†ã€å¯¹æ¯”åº¦ç­‰å¤šä¸ªå‚æ•°ï¼Œå¯æ ¹æ®ä¸åŒéœ€æ±‚è‡ªç”±è°ƒæ•´ï¼Œæ‰“é€ ä¸ªæ€§åŒ–çº¿ç¨¿æ•ˆæœ</p>
            <p><strong>ğŸ“± ä¾¿æ·æ“ä½œ</strong> - ç®€æ´ç›´è§‚çš„ç•Œé¢è®¾è®¡ï¼Œæ‹–æ‹½ä¸Šä¼ ã€ä¸€é”®ç”Ÿæˆï¼Œæ”¯æŒç§»åŠ¨ç«¯è®¿é—®ï¼Œéšæ—¶éšåœ°è½»æ¾ä½¿ç”¨</p>
            <p><strong>ğŸ”’ éšç§ä¿æŠ¤</strong> - æ‰€æœ‰å›¾ç‰‡å¤„ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œæ— éœ€ä¸Šä¼ æœåŠ¡å™¨ï¼Œç¡®ä¿æ‚¨çš„å›¾ç‰‡å®‰å…¨ï¼Œæ”¾å¿ƒä½¿ç”¨ä¸æ‹…å¿ƒ</p>
        </div>
    </div>

    <!-- åº•éƒ¨ -->
    
    <!-- é¡µè„šå°†é€šè¿‡JavaScriptç»„ä»¶è‡ªåŠ¨ç”Ÿæˆ -->

    <script>
        // DOM å…ƒç´ 
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const imageList = document.getElementById('imageList');
        const generateBtn = document.getElementById('generateBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        
        // è®¾ç½®å‚æ•°
        const edgeStrength = document.getElementById('edgeStrength');
        const lineThickness = document.getElementById('lineThickness');
        const contrast = document.getElementById('contrast');
        
        // æ•°å€¼æ˜¾ç¤ºå…ƒç´ 
        const edgeValue = document.getElementById('edgeValue');
        const thicknessValue = document.getElementById('thicknessValue');
        const contrastValue = document.getElementById('contrastValue');
        
        // é¢„ç½®æ¨¡æ¿
        const presets = {
            fine: { edge: 150, thickness: 1, contrast: 120 },
            bold: { edge: 100, thickness: 4, contrast: 130 },
            soft: { edge: 80, thickness: 2, contrast: 90 },
            sketch: { edge: 120, thickness: 3, contrast: 110 }
        };
        
        let imageFiles = [];
        let processedImages = new Map();
        
        // ä¸Šä¼ åŒºåŸŸç‚¹å‡»äº‹ä»¶
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
        fileInput.addEventListener('change', handleFileSelect);
        
        // æ‹–æ‹½äº‹ä»¶
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files);
            if (files.length > 0) {
                handleFiles(files);
            }
        });
        
        // æŒ‰é’®äº‹ä»¶
        generateBtn.addEventListener('click', generateSketch);
        downloadBtn.addEventListener('click', downloadSketch);
        resetBtn.addEventListener('click', resetTool);
        
        // é¢„ç½®æ¨¡æ¿æŒ‰é’®äº‹ä»¶
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = btn.dataset.preset;
                applyPreset(preset);
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });
        
        // æ»‘å—å®æ—¶æ›´æ–°æ•°å€¼æ˜¾ç¤º
        edgeStrength.addEventListener('input', () => {
            edgeValue.textContent = edgeStrength.value;
        });
        
        lineThickness.addEventListener('input', () => {
            thicknessValue.textContent = lineThickness.value;
        });
        
        contrast.addEventListener('input', () => {
            contrastValue.textContent = contrast.value;
        });
        
        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            if (files.length > 0) {
                handleFiles(files);
            }
        }
        
        // å¤„ç†å¤šä¸ªæ–‡ä»¶
        function handleFiles(files) {
            const validFiles = [];
            const errors = [];
            
            for (const file of files) {
                // éªŒè¯æ–‡ä»¶ç±»å‹
                if (!file.type.startsWith('image/')) {
                    errors.push(`"${file.name}" ä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶`);
                    continue;
                }
                
                // éªŒè¯æ–‡ä»¶å¤§å° (10MB)
                if (file.size > 10 * 1024 * 1024) {
                    errors.push(`"${file.name}" å¤§å°è¶…è¿‡ 10MB`);
                    continue;
                }
                
                validFiles.push(file);
            }
            
            // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
            if (errors.length > 0) {
                showToast(`è·³è¿‡ ${errors.length} ä¸ªæ— æ•ˆæ–‡ä»¶`, 'warning');
            }
            
            if (validFiles.length === 0) {
                showToast('æ²¡æœ‰æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶', 'error');
                return;
            }
            
            imageFiles = validFiles;
            processedImages.clear();
            displayImageList();
            previewContainer.style.display = 'block';
            generateBtn.disabled = false;
            downloadBtn.disabled = true;
            
            showToast(`æˆåŠŸåŠ è½½ ${validFiles.length} å¼ å›¾ç‰‡`, 'success');
        }
        
        // æ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨
        function displayImageList() {
            imageList.innerHTML = '';
            
            imageFiles.forEach((file, index) => {
                const imageItem = createImageItem(file, index);
                imageList.appendChild(imageItem);
            });
        }
        
        // åˆ›å»ºå›¾ç‰‡é¡¹ç›®
        function createImageItem(file, index) {
            const div = document.createElement('div');
            div.className = 'image-item';
            div.id = `image-item-${index}`;
            
            div.innerHTML = `
                <div class="image-item-header">
                    <div class="image-item-title">${file.name}</div>
                    <div class="image-item-status status-pending">å¾…å¤„ç†</div>
                </div>
                <div class="preview-grid">
                    <div class="preview-item">
                        <h4>åŸå§‹å›¾ç‰‡</h4>
                        <img class="preview-image" id="original-${index}" alt="åŸå§‹å›¾ç‰‡">
                    </div>
                    <div class="preview-item">
                        <h4>é“…ç¬”çº¿ç¨¿</h4>
                        <canvas class="preview-image" id="sketch-${index}"></canvas>
                    </div>
                </div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="generateSingleSketch(${index})">ç”Ÿæˆçº¿ç¨¿</button>
                    <button class="btn btn-success btn-small" onclick="downloadSingleSketch(${index})" disabled>ä¸‹è½½</button>
                </div>
            `;
            
            // åŠ è½½åŸå›¾é¢„è§ˆ
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = div.querySelector(`#original-${index}`);
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
            
            return div;
        }
        
        // æ‰¹é‡ç”Ÿæˆçº¿ç¨¿
        async function generateSketch() {
            if (imageFiles.length === 0) return;
            
            generateBtn.disabled = true;
            showProgress('å¼€å§‹æ‰¹é‡å¤„ç†...');
            
            for (let i = 0; i < imageFiles.length; i++) {
                updateProgress((i / imageFiles.length) * 100, `æ­£åœ¨å¤„ç†ç¬¬ ${i + 1}/${imageFiles.length} å¼ å›¾ç‰‡...`);
                await generateSingleSketch(i);
            }
            
            updateProgress(100, 'æ‰¹é‡å¤„ç†å®Œæˆï¼');
            setTimeout(() => {
                hideProgress();
                generateBtn.disabled = false;
                downloadBtn.disabled = false;
            }, 500);
        }
        
        // ç”Ÿæˆå•å¼ çº¿ç¨¿
        async function generateSingleSketch(index) {
            if (!imageFiles[index]) return;
            
            const imageItem = document.getElementById(`image-item-${index}`);
            const statusElement = imageItem.querySelector('.image-item-status');
            const originalImg = imageItem.querySelector(`#original-${index}`);
            const sketchCanvas = imageItem.querySelector(`#sketch-${index}`);
            const downloadBtn = imageItem.querySelector('.btn-success');
            
            try {
                // æ›´æ–°çŠ¶æ€
                statusElement.textContent = 'å¤„ç†ä¸­...';
                statusElement.className = 'image-item-status status-processing';
                
                // åˆ›å»ºå›¾ç‰‡å¯¹è±¡
                const img = new Image();
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = originalImg.src;
                });
                
                // å¤„ç†å›¾ç‰‡
                await processImageToSketch(img, sketchCanvas, index);
                
                // æ›´æ–°çŠ¶æ€
                statusElement.textContent = 'å·²å®Œæˆ';
                statusElement.className = 'image-item-status status-completed';
                downloadBtn.disabled = false;
                
                // ä¿å­˜å¤„ç†ç»“æœ
                processedImages.set(index, sketchCanvas.toDataURL('image/png'));
                
            } catch (error) {
                console.error(`å¤„ç†ç¬¬ ${index + 1} å¼ å›¾ç‰‡å¤±è´¥:`, error);
                statusElement.textContent = 'å¤„ç†å¤±è´¥';
                statusElement.className = 'image-item-status status-error';
            }
        }
        
        // å›¾ç‰‡è½¬çº¿ç¨¿å¤„ç†
        async function processImageToSketch(img, canvas, index) {
            const ctx = canvas.getContext('2d');
            
            // è®¾ç½®ç”»å¸ƒå°ºå¯¸
            canvas.width = img.width;
            canvas.height = img.height;
            
            // ç»˜åˆ¶åŸå›¾
            ctx.drawImage(img, 0, 0);
            
            // æ™ºèƒ½åˆ†æå›¾ç‰‡ç‰¹å¾ï¼ˆä»…åœ¨ç¬¬ä¸€å¼ å›¾ç‰‡æ—¶æ˜¾ç¤ºå»ºè®®ï¼‰
            if (index === 0 && processedImages.size === 0) {
                analyzeImageAndSuggest(ctx, img.width, img.height);
            }
            
            // è·å–å›¾åƒæ•°æ®
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // è½¬æ¢ä¸ºç°åº¦å›¾
            for (let i = 0; i < data.length; i += 4) {
                const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                data[i] = gray;
                data[i + 1] = gray;
                data[i + 2] = gray;
            }
            
            // è¾¹ç¼˜æ£€æµ‹ (Sobelç®—å­)
            const edgeData = detectEdges(data, canvas.width, canvas.height);
            
            // åº”ç”¨è®¾ç½®å‚æ•°
            const strength = parseInt(edgeStrength.value) / 100;
            const thickness = parseInt(lineThickness.value);
            const contrastValue = parseInt(contrast.value) / 100;
            
            // å¤„ç†è¾¹ç¼˜æ•°æ®
            for (let i = 0; i < edgeData.length; i += 4) {
                let intensity = edgeData[i] * strength * contrastValue;
                intensity = Math.min(255, Math.max(0, intensity));
                
                // åè½¬é¢œè‰² (é»‘çº¿ç™½åº•)
                const value = 255 - intensity;
                edgeData[i] = value;
                edgeData[i + 1] = value;
                edgeData[i + 2] = value;
                edgeData[i + 3] = 255;
            }
            
            // åº”ç”¨çº¿æ¡ç²—ç»†
            if (thickness > 1) {
                applyLineThickness(edgeData, canvas.width, canvas.height, thickness);
            }
            
            // ç»˜åˆ¶ç»“æœ
            const resultImageData = new ImageData(edgeData, canvas.width, canvas.height);
            ctx.putImageData(resultImageData, 0, 0);
            
            // æ·»åŠ å°å»¶è¿Ÿä»¥ç¡®ä¿UIæ›´æ–°
            await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        // è¾¹ç¼˜æ£€æµ‹ç®—æ³•
        function detectEdges(data, width, height) {
            const result = new Uint8ClampedArray(data.length);
            
            // Sobelç®—å­
            const sobelX = [-1, 0, 1, -2, 0, 2, -1, 0, 1];
            const sobelY = [-1, -2, -1, 0, 0, 0, 1, 2, 1];
            
            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    let gx = 0, gy = 0;
                    
                    for (let ky = -1; ky <= 1; ky++) {
                        for (let kx = -1; kx <= 1; kx++) {
                            const idx = ((y + ky) * width + (x + kx)) * 4;
                            const pixel = data[idx];
                            const kernelIdx = (ky + 1) * 3 + (kx + 1);
                            
                            gx += pixel * sobelX[kernelIdx];
                            gy += pixel * sobelY[kernelIdx];
                        }
                    }
                    
                    const magnitude = Math.sqrt(gx * gx + gy * gy);
                    const idx = (y * width + x) * 4;
                    
                    result[idx] = magnitude;
                    result[idx + 1] = magnitude;
                    result[idx + 2] = magnitude;
                    result[idx + 3] = 255;
                }
            }
            
            return result;
        }
        
        // åº”ç”¨çº¿æ¡ç²—ç»†
        function applyLineThickness(data, width, height, thickness) {
            const temp = new Uint8ClampedArray(data);
            const radius = Math.floor(thickness / 2);
            
            for (let y = radius; y < height - radius; y++) {
                for (let x = radius; x < width - radius; x++) {
                    const idx = (y * width + x) * 4;
                    
                    if (temp[idx] < 128) { // å¦‚æœæ˜¯çº¿æ¡åƒç´ 
                        // åœ¨å‘¨å›´åŒºåŸŸåŠ ç²—
                        for (let dy = -radius; dy <= radius; dy++) {
                            for (let dx = -radius; dx <= radius; dx++) {
                                if (dx * dx + dy * dy <= radius * radius) {
                                    const newIdx = ((y + dy) * width + (x + dx)) * 4;
                                    data[newIdx] = Math.min(data[newIdx], temp[idx]);
                                    data[newIdx + 1] = Math.min(data[newIdx + 1], temp[idx]);
                                    data[newIdx + 2] = Math.min(data[newIdx + 2], temp[idx]);
                                }
                            }
                        }
                    }
                }
            }
        }
        
        // æ‰¹é‡ä¸‹è½½çº¿ç¨¿
        function downloadSketch() {
            if (processedImages.size === 0) {
                alert('è¯·å…ˆç”Ÿæˆçº¿ç¨¿ï¼');
                return;
            }
            
            processedImages.forEach((dataUrl, index) => {
                const link = document.createElement('a');
                const fileName = imageFiles[index].name.replace(/\.[^/.]+$/, '');
                link.download = `${fileName}_sketch.png`;
                link.href = dataUrl;
                link.click();
                
                // æ·»åŠ å»¶è¿Ÿé¿å…æµè§ˆå™¨é˜»æ­¢å¤šä¸ªä¸‹è½½
                setTimeout(() => {}, 100);
            });
        }
        
        // ä¸‹è½½å•å¼ çº¿ç¨¿
        function downloadSingleSketch(index) {
            const canvas = document.getElementById(`sketch-${index}`);
            if (!canvas || !processedImages.has(index)) {
                alert('è¯·å…ˆç”Ÿæˆçº¿ç¨¿ï¼');
                return;
            }
            
            const link = document.createElement('a');
            const fileName = imageFiles[index].name.replace(/\.[^/.]+$/, '');
            link.download = `${fileName}_sketch.png`;
            link.href = processedImages.get(index);
            link.click();
        }
        
        // é‡ç½®å·¥å…·
        function resetTool() {
            imageFiles = [];
            processedImages.clear();
            imageList.innerHTML = '';
            previewContainer.style.display = 'none';
            generateBtn.disabled = true;
            downloadBtn.disabled = true;
            fileInput.value = '';
            hideProgress();
        }
        
        // æ˜¾ç¤ºè¿›åº¦
        function showProgress(text) {
            progressContainer.style.display = 'block';
            progressText.textContent = text;
            progressFill.style.width = '0%';
        }
        
        // æ›´æ–°è¿›åº¦
        function updateProgress(percent, text) {
            progressFill.style.width = percent + '%';
            progressText.textContent = text;
        }
        
        // éšè—è¿›åº¦
        function hideProgress() {
            progressContainer.style.display = 'none';
        }
        
        // åº”ç”¨é¢„ç½®æ¨¡æ¿
        function applyPreset(presetName) {
            const preset = presets[presetName];
            if (!preset) return;
            
            // æ›´æ–°æ»‘å—å€¼
            edgeStrength.value = preset.edge;
            lineThickness.value = preset.thickness;
            contrast.value = preset.contrast;
            
            // æ›´æ–°æ˜¾ç¤ºå€¼
            edgeValue.textContent = preset.edge;
            thicknessValue.textContent = preset.thickness;
            contrastValue.textContent = preset.contrast;
            
            // æ˜¾ç¤ºåº”ç”¨æˆåŠŸæç¤º
            showToast(`å·²åº”ç”¨ ${getPresetName(presetName)} é¢„è®¾`);
            
            // å¦‚æœæœ‰å›¾ç‰‡ï¼Œè‡ªåŠ¨é‡æ–°ç”Ÿæˆ
            if (imageFiles.length > 0 && processedImages.size > 0) {
                setTimeout(() => {
                    processedImages.forEach(async (_, index) => {
                        await generateSingleSketch(index);
                    });
                }, 300);
            }
        }
        
        // è·å–é¢„è®¾åç§°
        function getPresetName(preset) {
            const names = {
                fine: 'ç²¾ç»†çº¿ç¨¿',
                bold: 'ç²—çº¿æ¡',
                soft: 'æŸ”å’Œé£æ ¼',
                sketch: 'æ‰‹ç»˜é£æ ¼'
            };
            return names[preset] || preset;
        }
        
        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showToast(message, type = 'info') {
            // åˆ›å»ºæç¤ºå…ƒç´ 
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            // æ ¹æ®ç±»å‹è®¾ç½®å›¾æ ‡å’Œé¢œè‰²
            const icons = {
                success: 'âœ…',
                warning: 'âš ï¸',
                error: 'âŒ',
                info: 'â„¹ï¸'
            };
            
            const colors = {
                success: '#28a745',
                warning: '#ffc107',
                error: '#dc3545',
                info: '#007AFF'
            };
            
            toast.innerHTML = `${icons[type]} ${message}`;
            
            // æ·»åŠ æ ·å¼
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                font-size: 0.9rem;
                font-weight: 500;
                z-index: 1000;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                max-width: 300px;
                word-wrap: break-word;
            `;
            
            document.body.appendChild(toast);
            
            // æ˜¾ç¤ºåŠ¨ç”»
            setTimeout(() => {
                toast.style.opacity = '1';
                toast.style.transform = 'translateX(0)';
            }, 100);
            
            // è‡ªåŠ¨éšè—
            const hideDelay = type === 'error' ? 3000 : 2000;
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, hideDelay);
        }
        
        // æ™ºèƒ½åˆ†æå›¾ç‰‡å¹¶æ¨èé¢„è®¾
        function analyzeImageAndSuggest(ctx, width, height) {
            try {
                // é‡‡æ ·åˆ†æå›¾ç‰‡ç‰¹å¾
                const sampleSize = Math.min(100, Math.min(width, height));
                const imageData = ctx.getImageData(0, 0, sampleSize, sampleSize);
                const data = imageData.data;
                
                let totalBrightness = 0;
                let edgePixels = 0;
                let colorVariance = 0;
                
                // åˆ†æäº®åº¦å’Œè¾¹ç¼˜
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    // è®¡ç®—äº®åº¦
                    const brightness = (r + g + b) / 3;
                    totalBrightness += brightness;
                    
                    // ç®€å•è¾¹ç¼˜æ£€æµ‹
                    if (i > sampleSize * 4 && i < data.length - sampleSize * 4) {
                        const prevBrightness = (data[i - 4] + data[i - 3] + data[i - 2]) / 3;
                        if (Math.abs(brightness - prevBrightness) > 30) {
                            edgePixels++;
                        }
                    }
                    
                    // è®¡ç®—é¢œè‰²æ–¹å·®
                    const avg = (r + g + b) / 3;
                    colorVariance += Math.abs(r - avg) + Math.abs(g - avg) + Math.abs(b - avg);
                }
                
                const avgBrightness = totalBrightness / (data.length / 4);
                const edgeRatio = edgePixels / (data.length / 4);
                const avgColorVariance = colorVariance / (data.length / 4);
                
                // æ ¹æ®åˆ†æç»“æœæ¨èé¢„è®¾
                let recommendedPreset = 'fine'; // é»˜è®¤
                let reason = '';
                
                if (edgeRatio > 0.15) {
                    recommendedPreset = 'fine';
                    reason = 'å›¾ç‰‡ç»†èŠ‚ä¸°å¯Œï¼Œæ¨èç²¾ç»†çº¿ç¨¿';
                } else if (avgBrightness < 100) {
                    recommendedPreset = 'bold';
                    reason = 'å›¾ç‰‡è¾ƒæš—ï¼Œæ¨èç²—çº¿æ¡å¢å¼ºå¯¹æ¯”';
                } else if (avgColorVariance < 20) {
                    recommendedPreset = 'soft';
                    reason = 'å›¾ç‰‡è‰²å½©æŸ”å’Œï¼Œæ¨èæŸ”å’Œé£æ ¼';
                } else {
                    recommendedPreset = 'sketch';
                    reason = 'å›¾ç‰‡é€‚åˆæ‰‹ç»˜é£æ ¼å¤„ç†';
                }
                
                // æ˜¾ç¤ºæ™ºèƒ½æ¨è
                setTimeout(() => {
                    showToast(`ğŸ¤– ${reason}ï¼Œç‚¹å‡»åº”ç”¨æ¨èé¢„è®¾`, 'info');
                    
                    // é«˜äº®æ¨èçš„é¢„è®¾æŒ‰é’®
                    const recommendedBtn = document.querySelector(`[data-preset="${recommendedPreset}"]`);
                    if (recommendedBtn) {
                        recommendedBtn.style.animation = 'pulse 2s infinite';
                        
                        // æ·»åŠ è„‰å†²åŠ¨ç”»æ ·å¼
                        if (!document.querySelector('#pulse-animation')) {
                            const style = document.createElement('style');
                            style.id = 'pulse-animation';
                            style.textContent = `
                                @keyframes pulse {
                                    0% { box-shadow: 0 0 0 0 rgba(0, 122, 255, 0.7); }
                                    70% { box-shadow: 0 0 0 10px rgba(0, 122, 255, 0); }
                                    100% { box-shadow: 0 0 0 0 rgba(0, 122, 255, 0); }
                                }
                            `;
                            document.head.appendChild(style);
                        }
                        
                        // 5ç§’ååœæ­¢åŠ¨ç”»
                        setTimeout(() => {
                            recommendedBtn.style.animation = '';
                        }, 5000);
                    }
                }, 1000);
                
            } catch (error) {
                console.log('æ™ºèƒ½åˆ†æå¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤è®¾ç½®');
            }
        }
        
        // å‚æ•°å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°ç”Ÿæˆï¼ˆé˜²æŠ–ï¼‰
        let debounceTimer;
        [edgeStrength, lineThickness, contrast].forEach(input => {
            input.addEventListener('input', () => {
                if (imageFiles.length > 0 && !generateBtn.disabled) {
                    clearTimeout(debounceTimer);
                    debounceTimer = setTimeout(() => {
                        // é‡æ–°ç”Ÿæˆæ‰€æœ‰å·²å¤„ç†çš„å›¾ç‰‡
                        processedImages.forEach(async (_, index) => {
                            await generateSingleSketch(index);
                        });
                    }, 500);
                }
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–å¯¼èˆªæ å’Œé¡µè„šç»„ä»¶
            const navbar = new NavbarComponent();
            const navbarStyles = document.createElement('style');
            navbarStyles.textContent = NavbarComponent.getStyles();
            document.head.appendChild(navbarStyles);

            const footer = new FooterComponent();
            const footerStyles = document.createElement('style');
            footerStyles.textContent = FooterComponent.getStyles();
            document.head.appendChild(footerStyles);
});
    </script>
</body>
</html>