<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 导航栏和页脚组件 -->
    <script src="../components/navbar.js"></script>
    <script src="../components/footer.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>动漫图片转铅笔线稿工具 - 小路工具箱</title>
    <meta name="description" content="免费在线动漫图片转铅笔线稿工具，支持JPG、PNG等格式，一键生成人物轮廓线稿，适合儿童涂色使用，简洁易用的界面设计">
    <meta name="keywords" content="动漫转线稿,图片转铅笔画,线稿生成器,涂色线稿,动漫线稿,免费线稿工具,在线图片处理">
    <meta name="author" content="小路工具箱">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tools.xiaolu.page/tools/anime-to-sketch.html">
    <meta property="og:title" content="动漫图片转铅笔线稿工具 - 小路工具箱">
    <meta property="og:description" content="免费在线动漫图片转铅笔线稿工具，支持JPG、PNG等格式，一键生成人物轮廓线稿，适合儿童涂色使用">
    <meta property="og:image" content="https://tools.xiaolu.page/images/anime-to-sketch-preview.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tools.xiaolu.page/tools/anime-to-sketch.html">
    <meta property="twitter:title" content="动漫图片转铅笔线稿工具 - 小路工具箱">
    <meta property="twitter:description" content="免费在线动漫图片转铅笔线稿工具，支持JPG、PNG等格式，一键生成人物轮廓线稿，适合儿童涂色使用">
    <meta property="twitter:image" content="https://tools.xiaolu.page/images/anime-to-sketch-preview.jpg">
    
    <!-- 结构化数据 -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "动漫图片转铅笔线稿工具",
        "description": "免费在线动漫图片转铅笔线稿工具，支持JPG、PNG等格式，一键生成人物轮廓线稿，适合儿童涂色使用",
        "url": "https://tools.xiaolu.page/tools/anime-to-sketch.html",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CNY"
        }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        /* 导航栏样式由组件提供 */
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* 导航栏样式由组件提供 */
        
        /* 导航栏样式由组件提供 */
        
        /* 导航栏样式由组件提供 */
        
        /* 导航栏样式由组件提供 */
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .tool-header {
            text-align: center;
            margin: 0 auto 3rem auto;
            padding: 2rem 0;
            max-width: 800px;
        }
        
        .tool-header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .tool-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 1.5rem auto;
        }
        
        .tool-features {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        
        .feature-tag {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .step-content h4 {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .step-content p {
            color: #666;
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        .main-content {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 0 auto 2rem auto;
            flex: 1;
            max-width: 1200px;
        }
        
        .content-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: start;
        }
        
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            min-height: 500px;
        }
        
        .right-panel {
            min-height: 500px;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        .upload-area {
            border: 3px dashed #007AFF;
            border-radius: 15px;
            padding: 3rem;
            text-align: center;
            background: #f8f9ff;
            transition: all 0.3s ease;
            margin-bottom: 2rem;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: #0056b3;
            background: #f0f4ff;
        }
        
        .upload-area.dragover {
            border-color: #28a745;
            background: #f0fff4;
        }
        
        .upload-icon {
            font-size: 4rem;
            color: #007AFF;
            margin-bottom: 1rem;
        }
        
        .upload-text {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 1rem;
        }
        
        .upload-hint {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 1rem;
        }
        
        .upload-tips {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            margin-top: 1rem;
        }
        
        .tip-item {
            font-size: 0.8rem;
            color: #666;
            text-align: left;
        }
        
        .example-section {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .example-title {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .example-grid {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        
        .example-item {
            text-align: center;
            flex: 1;
        }
        
        .example-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .example-placeholder {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .example-arrow {
            font-size: 1.5rem;
            color: #007AFF;
            font-weight: bold;
        }
        
        .file-input {
            display: none;
        }
        
        .preview-container {
            display: none;
            margin-top: 2rem;
            flex: 1;
            overflow-y: auto;
            max-height: 600px;
        }
        
        .image-list {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            padding-right: 1rem;
        }
        
        .image-item {
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 1.5rem;
            background: #fafafa;
        }
        
        .image-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .image-item-title {
            font-weight: 600;
            color: #333;
            font-size: 1.1rem;
        }
        
        .image-item-status {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-processing {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .preview-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .preview-item {
            text-align: center;
        }
        
        .preview-item h4 {
            margin-bottom: 0.8rem;
            color: #555;
            font-size: 1rem;
        }
        
        .preview-image {
            width: 100%;
            max-height: 250px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            object-fit: contain;
            background: #f8f9fa;
        }
        
        .image-actions {
            margin-top: 1rem;
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            border-radius: 6px;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            text-align: center;
            width: 100%;
        }
        
        .btn-primary {
            background: #007AFF;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #1e7e34;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-container {
            display: none;
            margin: 2rem 0;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007AFF, #0056b3);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            color: #666;
            font-size: 0.9rem;
        }
        
        .settings-panel {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 2rem;
        }
        
        .settings-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #333;
            text-align: center;
        }
        
        .setting-group {
            margin-bottom: 1rem;
        }
        
        .setting-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #555;
        }
        
        .setting-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .preset-btn {
            padding: 0.6rem 1rem;
            border: 2px solid #007AFF;
            background: white;
            color: #007AFF;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .preset-btn:hover {
            background: #007AFF;
            color: white;
            transform: translateY(-1px);
        }
        
        .preset-btn.active {
            background: #007AFF;
            color: white;
        }
        
        .setting-label span {
            color: #007AFF;
            font-weight: 600;
        }
        
        .info-section {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .info-section h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        
        .info-section h3 {
            color: #007AFF;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }
        
        .info-section p, .info-section li {
            color: #666;
            margin-bottom: 0.8rem;
        }
        
        .info-section ul {
            padding-left: 1.5rem;
        }
        
        .tips-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 3rem;
            margin: 2rem auto;
            max-width: 1200px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            color: white;
        }
        
        .tips-section h2 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 2.5rem;
            font-weight: 600;
            color: white;
        }
        
        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .tip-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .tip-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        
        .tip-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .tip-card h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: white;
        }
        
        .tip-card p {
            line-height: 1.6;
            font-size: 0.9rem;
            opacity: 0.9;
            color: white;
        }
        
        .final-note {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            margin-top: 2rem;
        }
        
        .final-note p {
            margin: 0;
            font-size: 1rem;
            line-height: 1.6;
            color: white;
        }
        
        .final-note strong {
            color: #FFD700;
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 2rem 0;
            text-align: center;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: #666;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: #007AFF;
        }
        
        .footer-text {
            color: #999;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            /* 导航栏样式由组件提供 */
            
            .container {
                padding: 1rem;
            }
            
            .main-content {
                padding: 2rem 1.5rem;
            }
            
            .content-layout {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .settings-panel {
                position: static;
                margin-bottom: 2rem;
            }
            
            .preview-container {
                max-height: none;
                overflow: visible;
            }
            
            .tool-header h1 {
                font-size: 2rem;
            }
            
            .preview-grid {
                grid-template-columns: 1fr;
            }
            
            .image-item {
                padding: 1rem;
            }
            
            .image-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
            
            .tool-features {
                gap: 0.5rem;
            }
            
            .feature-tag {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            .preset-buttons {
                grid-template-columns: 1fr;
                gap: 0.3rem;
            }
            
            .preset-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .example-grid {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .example-arrow {
                transform: rotate(90deg);
            }
            
            .upload-tips {
                gap: 0.2rem;
            }
            
            .tip-item {
                font-size: 0.75rem;
            }
            

        }
    </style>

    <!-- 导航栏和页脚组件 -->
    <script src="../components/navbar.js"></script>
    <script src="../components/footer.js"></script>
</head>
<body>
    <!-- 导航栏 -->
    
    <!-- 导航栏将通过JavaScript组件自动生成 -->

    <div class="container">
        <!-- 工具标题 -->
        <div class="tool-header">
            <h1>🎨 动漫图片转铅笔线稿</h1>
            <p>将动漫图片一键转换为精美线稿，支持批量处理，完全免费使用</p>
            
            <div class="tool-features">
                <span class="feature-tag">✨ 实时预览</span>
                <span class="feature-tag">🚀 批量处理</span>
                <span class="feature-tag">🎯 智能优化</span>
                <span class="feature-tag">📱 移动友好</span>
            </div>
        </div>

        <!-- 主要内容 -->
        <div class="main-content">
            <div class="content-layout">
                <!-- 左侧面板 -->
                <div class="left-panel">
                    <!-- 上传区域 -->
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">📸</div>
                        <div class="upload-text">拖拽动漫图片到此处或点击选择文件</div>
                        <div class="upload-hint">支持 JPG、PNG、GIF、BMP、WEBP 等格式，可同时选择多张图片</div>
                        <div class="upload-tips">
                            <div class="tip-item">💡 建议使用清晰的动漫人物图片</div>
                            <div class="tip-item">📏 推荐分辨率：500x500 - 2000x2000</div>
                            <div class="tip-item">📦 文件大小：不超过 10MB</div>
                        </div>
                        <input type="file" id="fileInput" class="file-input" accept="image/*" multiple>
                    </div>
                    
                    <!-- 示例图片 -->
                    <div class="example-section">
                        <div class="example-title">📖 效果示例</div>
                        <div class="example-grid">
                            <div class="example-item">
                                <div class="example-label">原图</div>
                                <div class="example-placeholder">🎭</div>
                            </div>
                            <div class="example-arrow">→</div>
                            <div class="example-item">
                                <div class="example-label">线稿</div>
                                <div class="example-placeholder">✏️</div>
                            </div>
                        </div>
                    </div>

                    <!-- 预览区域 -->
                    <div class="preview-container" id="previewContainer">
                        <div id="imageList" class="image-list"></div>
                    </div>
                </div>

                <!-- 右侧面板 -->
                <div class="right-panel">
                    <!-- 设置面板 -->
                    <div class="settings-panel">
                        <div class="settings-title">线稿设置</div>
                        
                        <!-- 预置模板 -->
                        <div class="setting-group">
                            <label class="setting-label">快速预设</label>
                            <div class="preset-buttons">
                                <button class="preset-btn" data-preset="fine">精细线稿</button>
                                <button class="preset-btn" data-preset="bold">粗线条</button>
                                <button class="preset-btn" data-preset="soft">柔和风格</button>
                                <button class="preset-btn" data-preset="sketch">手绘风格</button>
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">边缘检测强度 <span id="edgeValue">100</span></label>
                            <input type="range" id="edgeStrength" class="setting-input" min="50" max="200" value="100">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">线条粗细 <span id="thicknessValue">2</span></label>
                            <input type="range" id="lineThickness" class="setting-input" min="1" max="5" value="2">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">对比度 <span id="contrastValue">100</span></label>
                            <input type="range" id="contrast" class="setting-input" min="50" max="150" value="100">
                        </div>
                    </div>

                    <!-- 控制按钮 -->
                    <div class="controls">
                        <button id="generateBtn" class="btn btn-primary">批量生成线稿</button>
                        <button id="downloadBtn" class="btn btn-success" disabled>下载所有线稿</button>
                        <button id="resetBtn" class="btn btn-secondary">重新选择</button>
                    </div>

                    <!-- 进度条 -->
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">处理中...</div>
                    </div>
                </div>
            </div>
        </div>



        <!-- 使用说明 -->
        <div class="info-section">
            <h2>📖 使用说明</h2>
            
            <h3>使用步骤</h3>
            <p><strong>1. 上传图片</strong> → 点击上传区域或拖拽图片，支持JPG、PNG、GIF等格式</p>
            <p><strong>2. 调整参数</strong> → 使用预设模板或手动调整边缘强度、线条粗细、对比度</p>
            <p><strong>3. 生成下载</strong> → 点击生成按钮处理图片，完成后下载线稿</p>
            
            <h3>使用场景</h3>
            <p><strong>🎨 儿童涂色</strong> - 制作专属涂色素材 | <strong>📚 美术教学</strong> - 快速制作教材 | <strong>💡 设计参考</strong> - 提取轮廓结构 | <strong>🎭 同人创作</strong> - 线稿基础素材</p>
            
            <h3>使用技巧</h3>
            <p>选择轮廓清晰的动漫人物图片效果最佳，建议分辨率500-2000像素，可多次调整参数获得满意效果。所有处理在浏览器本地完成，保护隐私安全。</p>
        </div>

        <!-- 常见问题 -->
        <div class="info-section">
            <h2>❓ 常见问题</h2>
            
            <h3>Q: 支持哪些图片格式？</h3>
            <p>A: 支持 JPG、PNG、GIF、BMP、WEBP 等常见图片格式，推荐使用 PNG 或 JPG 格式以获得最佳效果。</p>
            
            <h3>Q: 图片大小有限制吗？</h3>
            <p>A: 建议上传的图片文件大小不超过 10MB，分辨率在 500x500 到 2000x2000 像素之间效果最佳。</p>
            
            <h3>Q: 生成的线稿不够清晰怎么办？</h3>
            <p>A: 可以尝试调整"边缘检测强度"参数，增加数值可以获得更清晰的线条，或者选择对比度更高的原图。</p>
            
            <h3>Q: 可以批量处理图片吗？</h3>
            <p>A: 支持批量处理！您可以同时选择多张图片，然后点击"批量生成线稿"一次性处理所有图片，也可以单独处理指定的图片。</p>
            
            <h3>Q: 生成的线稿可以商用吗？</h3>
            <p>A: 工具本身免费使用，但请确保原图片的版权合规，生成的线稿用途需遵守相关法律法规。</p>
            
            <h3>Q: 处理速度慢怎么办？</h3>
            <p>A: 处理速度取决于图片大小和设备性能，建议使用较新的浏览器，并确保网络连接稳定。</p>
        </div>
        
        <!-- 工具优势 -->
        <div class="info-section">
            <h2>🌟 工具优势</h2>
            <p><strong>⚡ 一键转换</strong> - 智能算法自动识别，无需复杂设置 | <strong>🎨 高清输出</strong> - 保持原图分辨率，线条清晰流畅</p>
            <p><strong>🔧 参数可调</strong> - 多种预设模板，支持精细调节 | <strong>🌐 免安装</strong> - 浏览器直接使用，支持所有设备</p>
            <p><strong>📦 批量处理</strong> - 同时处理多张图片，提升效率 | <strong>💝 完全免费</strong> - 所有功能免费开放，无隐藏费用</p>
        </div>

        <!-- 工具特色 -->
        <div class="info-section">
            <h2>🎯 工具特色</h2>
            <p><strong>🎨 智能线稿</strong> - 采用先进的边缘检测算法，精准提取图片轮廓，生成清晰流畅的线条，完美还原原图细节</p>
            <p><strong>🛠️ 灵活调节</strong> - 提供边缘强度、线条粗细、对比度等多个参数，可根据不同需求自由调整，打造个性化线稿效果</p>
            <p><strong>📱 便捷操作</strong> - 简洁直观的界面设计，拖拽上传、一键生成，支持移动端访问，随时随地轻松使用</p>
            <p><strong>🔒 隐私保护</strong> - 所有图片处理均在本地完成，无需上传服务器，确保您的图片安全，放心使用不担心</p>
        </div>
    </div>

    <!-- 底部 -->
    
    <!-- 页脚将通过JavaScript组件自动生成 -->

    <script>
        // DOM 元素
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const imageList = document.getElementById('imageList');
        const generateBtn = document.getElementById('generateBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        
        // 设置参数
        const edgeStrength = document.getElementById('edgeStrength');
        const lineThickness = document.getElementById('lineThickness');
        const contrast = document.getElementById('contrast');
        
        // 数值显示元素
        const edgeValue = document.getElementById('edgeValue');
        const thicknessValue = document.getElementById('thicknessValue');
        const contrastValue = document.getElementById('contrastValue');
        
        // 预置模板
        const presets = {
            fine: { edge: 150, thickness: 1, contrast: 120 },
            bold: { edge: 100, thickness: 4, contrast: 130 },
            soft: { edge: 80, thickness: 2, contrast: 90 },
            sketch: { edge: 120, thickness: 3, contrast: 110 }
        };
        
        let imageFiles = [];
        let processedImages = new Map();
        
        // 上传区域点击事件
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        // 文件选择事件
        fileInput.addEventListener('change', handleFileSelect);
        
        // 拖拽事件
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files);
            if (files.length > 0) {
                handleFiles(files);
            }
        });
        
        // 按钮事件
        generateBtn.addEventListener('click', generateSketch);
        downloadBtn.addEventListener('click', downloadSketch);
        resetBtn.addEventListener('click', resetTool);
        
        // 预置模板按钮事件
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = btn.dataset.preset;
                applyPreset(preset);
                
                // 更新按钮状态
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });
        
        // 滑块实时更新数值显示
        edgeStrength.addEventListener('input', () => {
            edgeValue.textContent = edgeStrength.value;
        });
        
        lineThickness.addEventListener('input', () => {
            thicknessValue.textContent = lineThickness.value;
        });
        
        contrast.addEventListener('input', () => {
            contrastValue.textContent = contrast.value;
        });
        
        // 处理文件选择
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            if (files.length > 0) {
                handleFiles(files);
            }
        }
        
        // 处理多个文件
        function handleFiles(files) {
            const validFiles = [];
            const errors = [];
            
            for (const file of files) {
                // 验证文件类型
                if (!file.type.startsWith('image/')) {
                    errors.push(`"${file.name}" 不是有效的图片文件`);
                    continue;
                }
                
                // 验证文件大小 (10MB)
                if (file.size > 10 * 1024 * 1024) {
                    errors.push(`"${file.name}" 大小超过 10MB`);
                    continue;
                }
                
                validFiles.push(file);
            }
            
            // 显示错误信息
            if (errors.length > 0) {
                showToast(`跳过 ${errors.length} 个无效文件`, 'warning');
            }
            
            if (validFiles.length === 0) {
                showToast('没有有效的图片文件', 'error');
                return;
            }
            
            imageFiles = validFiles;
            processedImages.clear();
            displayImageList();
            previewContainer.style.display = 'block';
            generateBtn.disabled = false;
            downloadBtn.disabled = true;
            
            showToast(`成功加载 ${validFiles.length} 张图片`, 'success');
        }
        
        // 显示图片列表
        function displayImageList() {
            imageList.innerHTML = '';
            
            imageFiles.forEach((file, index) => {
                const imageItem = createImageItem(file, index);
                imageList.appendChild(imageItem);
            });
        }
        
        // 创建图片项目
        function createImageItem(file, index) {
            const div = document.createElement('div');
            div.className = 'image-item';
            div.id = `image-item-${index}`;
            
            div.innerHTML = `
                <div class="image-item-header">
                    <div class="image-item-title">${file.name}</div>
                    <div class="image-item-status status-pending">待处理</div>
                </div>
                <div class="preview-grid">
                    <div class="preview-item">
                        <h4>原始图片</h4>
                        <img class="preview-image" id="original-${index}" alt="原始图片">
                    </div>
                    <div class="preview-item">
                        <h4>铅笔线稿</h4>
                        <canvas class="preview-image" id="sketch-${index}"></canvas>
                    </div>
                </div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="generateSingleSketch(${index})">生成线稿</button>
                    <button class="btn btn-success btn-small" onclick="downloadSingleSketch(${index})" disabled>下载</button>
                </div>
            `;
            
            // 加载原图预览
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = div.querySelector(`#original-${index}`);
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
            
            return div;
        }
        
        // 批量生成线稿
        async function generateSketch() {
            if (imageFiles.length === 0) return;
            
            generateBtn.disabled = true;
            showProgress('开始批量处理...');
            
            for (let i = 0; i < imageFiles.length; i++) {
                updateProgress((i / imageFiles.length) * 100, `正在处理第 ${i + 1}/${imageFiles.length} 张图片...`);
                await generateSingleSketch(i);
            }
            
            updateProgress(100, '批量处理完成！');
            setTimeout(() => {
                hideProgress();
                generateBtn.disabled = false;
                downloadBtn.disabled = false;
            }, 500);
        }
        
        // 生成单张线稿
        async function generateSingleSketch(index) {
            if (!imageFiles[index]) return;
            
            const imageItem = document.getElementById(`image-item-${index}`);
            const statusElement = imageItem.querySelector('.image-item-status');
            const originalImg = imageItem.querySelector(`#original-${index}`);
            const sketchCanvas = imageItem.querySelector(`#sketch-${index}`);
            const downloadBtn = imageItem.querySelector('.btn-success');
            
            try {
                // 更新状态
                statusElement.textContent = '处理中...';
                statusElement.className = 'image-item-status status-processing';
                
                // 创建图片对象
                const img = new Image();
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = originalImg.src;
                });
                
                // 处理图片
                await processImageToSketch(img, sketchCanvas, index);
                
                // 更新状态
                statusElement.textContent = '已完成';
                statusElement.className = 'image-item-status status-completed';
                downloadBtn.disabled = false;
                
                // 保存处理结果
                processedImages.set(index, sketchCanvas.toDataURL('image/png'));
                
            } catch (error) {
                console.error(`处理第 ${index + 1} 张图片失败:`, error);
                statusElement.textContent = '处理失败';
                statusElement.className = 'image-item-status status-error';
            }
        }
        
        // 图片转线稿处理
        async function processImageToSketch(img, canvas, index) {
            const ctx = canvas.getContext('2d');
            
            // 设置画布尺寸
            canvas.width = img.width;
            canvas.height = img.height;
            
            // 绘制原图
            ctx.drawImage(img, 0, 0);
            
            // 智能分析图片特征（仅在第一张图片时显示建议）
            if (index === 0 && processedImages.size === 0) {
                analyzeImageAndSuggest(ctx, img.width, img.height);
            }
            
            // 获取图像数据
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // 转换为灰度图
            for (let i = 0; i < data.length; i += 4) {
                const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                data[i] = gray;
                data[i + 1] = gray;
                data[i + 2] = gray;
            }
            
            // 边缘检测 (Sobel算子)
            const edgeData = detectEdges(data, canvas.width, canvas.height);
            
            // 应用设置参数
            const strength = parseInt(edgeStrength.value) / 100;
            const thickness = parseInt(lineThickness.value);
            const contrastValue = parseInt(contrast.value) / 100;
            
            // 处理边缘数据
            for (let i = 0; i < edgeData.length; i += 4) {
                let intensity = edgeData[i] * strength * contrastValue;
                intensity = Math.min(255, Math.max(0, intensity));
                
                // 反转颜色 (黑线白底)
                const value = 255 - intensity;
                edgeData[i] = value;
                edgeData[i + 1] = value;
                edgeData[i + 2] = value;
                edgeData[i + 3] = 255;
            }
            
            // 应用线条粗细
            if (thickness > 1) {
                applyLineThickness(edgeData, canvas.width, canvas.height, thickness);
            }
            
            // 绘制结果
            const resultImageData = new ImageData(edgeData, canvas.width, canvas.height);
            ctx.putImageData(resultImageData, 0, 0);
            
            // 添加小延迟以确保UI更新
            await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        // 边缘检测算法
        function detectEdges(data, width, height) {
            const result = new Uint8ClampedArray(data.length);
            
            // Sobel算子
            const sobelX = [-1, 0, 1, -2, 0, 2, -1, 0, 1];
            const sobelY = [-1, -2, -1, 0, 0, 0, 1, 2, 1];
            
            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    let gx = 0, gy = 0;
                    
                    for (let ky = -1; ky <= 1; ky++) {
                        for (let kx = -1; kx <= 1; kx++) {
                            const idx = ((y + ky) * width + (x + kx)) * 4;
                            const pixel = data[idx];
                            const kernelIdx = (ky + 1) * 3 + (kx + 1);
                            
                            gx += pixel * sobelX[kernelIdx];
                            gy += pixel * sobelY[kernelIdx];
                        }
                    }
                    
                    const magnitude = Math.sqrt(gx * gx + gy * gy);
                    const idx = (y * width + x) * 4;
                    
                    result[idx] = magnitude;
                    result[idx + 1] = magnitude;
                    result[idx + 2] = magnitude;
                    result[idx + 3] = 255;
                }
            }
            
            return result;
        }
        
        // 应用线条粗细
        function applyLineThickness(data, width, height, thickness) {
            const temp = new Uint8ClampedArray(data);
            const radius = Math.floor(thickness / 2);
            
            for (let y = radius; y < height - radius; y++) {
                for (let x = radius; x < width - radius; x++) {
                    const idx = (y * width + x) * 4;
                    
                    if (temp[idx] < 128) { // 如果是线条像素
                        // 在周围区域加粗
                        for (let dy = -radius; dy <= radius; dy++) {
                            for (let dx = -radius; dx <= radius; dx++) {
                                if (dx * dx + dy * dy <= radius * radius) {
                                    const newIdx = ((y + dy) * width + (x + dx)) * 4;
                                    data[newIdx] = Math.min(data[newIdx], temp[idx]);
                                    data[newIdx + 1] = Math.min(data[newIdx + 1], temp[idx]);
                                    data[newIdx + 2] = Math.min(data[newIdx + 2], temp[idx]);
                                }
                            }
                        }
                    }
                }
            }
        }
        
        // 批量下载线稿
        function downloadSketch() {
            if (processedImages.size === 0) {
                alert('请先生成线稿！');
                return;
            }
            
            processedImages.forEach((dataUrl, index) => {
                const link = document.createElement('a');
                const fileName = imageFiles[index].name.replace(/\.[^/.]+$/, '');
                link.download = `${fileName}_sketch.png`;
                link.href = dataUrl;
                link.click();
                
                // 添加延迟避免浏览器阻止多个下载
                setTimeout(() => {}, 100);
            });
        }
        
        // 下载单张线稿
        function downloadSingleSketch(index) {
            const canvas = document.getElementById(`sketch-${index}`);
            if (!canvas || !processedImages.has(index)) {
                alert('请先生成线稿！');
                return;
            }
            
            const link = document.createElement('a');
            const fileName = imageFiles[index].name.replace(/\.[^/.]+$/, '');
            link.download = `${fileName}_sketch.png`;
            link.href = processedImages.get(index);
            link.click();
        }
        
        // 重置工具
        function resetTool() {
            imageFiles = [];
            processedImages.clear();
            imageList.innerHTML = '';
            previewContainer.style.display = 'none';
            generateBtn.disabled = true;
            downloadBtn.disabled = true;
            fileInput.value = '';
            hideProgress();
        }
        
        // 显示进度
        function showProgress(text) {
            progressContainer.style.display = 'block';
            progressText.textContent = text;
            progressFill.style.width = '0%';
        }
        
        // 更新进度
        function updateProgress(percent, text) {
            progressFill.style.width = percent + '%';
            progressText.textContent = text;
        }
        
        // 隐藏进度
        function hideProgress() {
            progressContainer.style.display = 'none';
        }
        
        // 应用预置模板
        function applyPreset(presetName) {
            const preset = presets[presetName];
            if (!preset) return;
            
            // 更新滑块值
            edgeStrength.value = preset.edge;
            lineThickness.value = preset.thickness;
            contrast.value = preset.contrast;
            
            // 更新显示值
            edgeValue.textContent = preset.edge;
            thicknessValue.textContent = preset.thickness;
            contrastValue.textContent = preset.contrast;
            
            // 显示应用成功提示
            showToast(`已应用 ${getPresetName(presetName)} 预设`);
            
            // 如果有图片，自动重新生成
            if (imageFiles.length > 0 && processedImages.size > 0) {
                setTimeout(() => {
                    processedImages.forEach(async (_, index) => {
                        await generateSingleSketch(index);
                    });
                }, 300);
            }
        }
        
        // 获取预设名称
        function getPresetName(preset) {
            const names = {
                fine: '精细线稿',
                bold: '粗线条',
                soft: '柔和风格',
                sketch: '手绘风格'
            };
            return names[preset] || preset;
        }
        
        // 显示提示消息
        function showToast(message, type = 'info') {
            // 创建提示元素
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            // 根据类型设置图标和颜色
            const icons = {
                success: '✅',
                warning: '⚠️',
                error: '❌',
                info: 'ℹ️'
            };
            
            const colors = {
                success: '#28a745',
                warning: '#ffc107',
                error: '#dc3545',
                info: '#007AFF'
            };
            
            toast.innerHTML = `${icons[type]} ${message}`;
            
            // 添加样式
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                font-size: 0.9rem;
                font-weight: 500;
                z-index: 1000;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                max-width: 300px;
                word-wrap: break-word;
            `;
            
            document.body.appendChild(toast);
            
            // 显示动画
            setTimeout(() => {
                toast.style.opacity = '1';
                toast.style.transform = 'translateX(0)';
            }, 100);
            
            // 自动隐藏
            const hideDelay = type === 'error' ? 3000 : 2000;
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, hideDelay);
        }
        
        // 智能分析图片并推荐预设
        function analyzeImageAndSuggest(ctx, width, height) {
            try {
                // 采样分析图片特征
                const sampleSize = Math.min(100, Math.min(width, height));
                const imageData = ctx.getImageData(0, 0, sampleSize, sampleSize);
                const data = imageData.data;
                
                let totalBrightness = 0;
                let edgePixels = 0;
                let colorVariance = 0;
                
                // 分析亮度和边缘
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    // 计算亮度
                    const brightness = (r + g + b) / 3;
                    totalBrightness += brightness;
                    
                    // 简单边缘检测
                    if (i > sampleSize * 4 && i < data.length - sampleSize * 4) {
                        const prevBrightness = (data[i - 4] + data[i - 3] + data[i - 2]) / 3;
                        if (Math.abs(brightness - prevBrightness) > 30) {
                            edgePixels++;
                        }
                    }
                    
                    // 计算颜色方差
                    const avg = (r + g + b) / 3;
                    colorVariance += Math.abs(r - avg) + Math.abs(g - avg) + Math.abs(b - avg);
                }
                
                const avgBrightness = totalBrightness / (data.length / 4);
                const edgeRatio = edgePixels / (data.length / 4);
                const avgColorVariance = colorVariance / (data.length / 4);
                
                // 根据分析结果推荐预设
                let recommendedPreset = 'fine'; // 默认
                let reason = '';
                
                if (edgeRatio > 0.15) {
                    recommendedPreset = 'fine';
                    reason = '图片细节丰富，推荐精细线稿';
                } else if (avgBrightness < 100) {
                    recommendedPreset = 'bold';
                    reason = '图片较暗，推荐粗线条增强对比';
                } else if (avgColorVariance < 20) {
                    recommendedPreset = 'soft';
                    reason = '图片色彩柔和，推荐柔和风格';
                } else {
                    recommendedPreset = 'sketch';
                    reason = '图片适合手绘风格处理';
                }
                
                // 显示智能推荐
                setTimeout(() => {
                    showToast(`🤖 ${reason}，点击应用推荐预设`, 'info');
                    
                    // 高亮推荐的预设按钮
                    const recommendedBtn = document.querySelector(`[data-preset="${recommendedPreset}"]`);
                    if (recommendedBtn) {
                        recommendedBtn.style.animation = 'pulse 2s infinite';
                        
                        // 添加脉冲动画样式
                        if (!document.querySelector('#pulse-animation')) {
                            const style = document.createElement('style');
                            style.id = 'pulse-animation';
                            style.textContent = `
                                @keyframes pulse {
                                    0% { box-shadow: 0 0 0 0 rgba(0, 122, 255, 0.7); }
                                    70% { box-shadow: 0 0 0 10px rgba(0, 122, 255, 0); }
                                    100% { box-shadow: 0 0 0 0 rgba(0, 122, 255, 0); }
                                }
                            `;
                            document.head.appendChild(style);
                        }
                        
                        // 5秒后停止动画
                        setTimeout(() => {
                            recommendedBtn.style.animation = '';
                        }, 5000);
                    }
                }, 1000);
                
            } catch (error) {
                console.log('智能分析失败，使用默认设置');
            }
        }
        
        // 参数变化时自动重新生成（防抖）
        let debounceTimer;
        [edgeStrength, lineThickness, contrast].forEach(input => {
            input.addEventListener('input', () => {
                if (imageFiles.length > 0 && !generateBtn.disabled) {
                    clearTimeout(debounceTimer);
                    debounceTimer = setTimeout(() => {
                        // 重新生成所有已处理的图片
                        processedImages.forEach(async (_, index) => {
                            await generateSingleSketch(index);
                        });
                    }, 500);
                }
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化导航栏和页脚组件
            const navbar = new NavbarComponent();
            const navbarStyles = document.createElement('style');
            navbarStyles.textContent = NavbarComponent.getStyles();
            document.head.appendChild(navbarStyles);

            const footer = new FooterComponent();
            const footerStyles = document.createElement('style');
            footerStyles.textContent = FooterComponent.getStyles();
            document.head.appendChild(footerStyles);
});
    </script>
</body>
</html>