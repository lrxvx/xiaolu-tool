<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒæ—¶å·®è®¡ç®—å™¨ - å°è·¯å·¥å…·ç®±</title>
    <meta name="description" content="ä¸“ä¸šçš„å…¨çƒæ—¶å·®è®¡ç®—å·¥å…·ï¼Œå®æ—¶æ˜¾ç¤ºä¸–ç•Œå„åœ°æ—¶é—´ã€æ—¶åŒºã€æ—¥å‡ºæ—¥è½æ—¶é—´ï¼Œæ”¯æŒå†œå†å…¬å†å¯¹æ¯”ï¼Œå®Œç¾è§£å†³æ—¶å·®é—®é¢˜">
    <meta name="keywords" content="æ—¶å·®è®¡ç®—å™¨,ä¸–ç•Œæ—¶é—´,æ—¶åŒºè½¬æ¢,æ—¥å‡ºæ—¥è½,å†œå†å…¬å†,å…¨çƒæ—¶é—´">
    <meta name="author" content="å°è·¯å·¥å…·ç®±">
    
    <!-- Open Graph -->
    <meta property="og:title" content="å…¨çƒæ—¶å·®è®¡ç®—å™¨ - å°è·¯å·¥å…·ç®±">
    <meta property="og:description" content="ä¸“ä¸šçš„å…¨çƒæ—¶å·®è®¡ç®—å·¥å…·ï¼Œå®æ—¶æ˜¾ç¤ºä¸–ç•Œå„åœ°æ—¶é—´ã€æ—¶åŒºã€æ—¥å‡ºæ—¥è½æ—¶é—´">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tools.xiaolu.page/tools/timezone-calculator.html">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="å…¨çƒæ—¶å·®è®¡ç®—å™¨ - å°è·¯å·¥å…·ç®±">
    <meta name="twitter:description" content="ä¸“ä¸šçš„å…¨çƒæ—¶å·®è®¡ç®—å·¥å…·ï¼Œå®æ—¶æ˜¾ç¤ºä¸–ç•Œå„åœ°æ—¶é—´ã€æ—¶åŒºã€æ—¥å‡ºæ—¥è½æ—¶é—´">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "å…¨çƒæ—¶å·®è®¡ç®—å™¨",
        "description": "ä¸“ä¸šçš„å…¨çƒæ—¶å·®è®¡ç®—å·¥å…·ï¼Œå®æ—¶æ˜¾ç¤ºä¸–ç•Œå„åœ°æ—¶é—´ã€æ—¶åŒºã€æ—¥å‡ºæ—¥è½æ—¶é—´",
        "url": "https://tools.xiaolu.page/tools/timezone-calculator.html",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: #667eea;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 3rem;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .timezone-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .timezone-card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            margin-right: 1rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .local-icon {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }
        
        .target-icon {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
        }
        
        .timezone-select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            margin-bottom: 1.5rem;
            background: white;
            transition: border-color 0.3s;
        }
        
        .timezone-select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .custom-input-container {
            margin-bottom: 1.5rem;
        }
        
        .custom-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
            transition: border-color 0.3s;
            margin-bottom: 0.5rem;
        }
        
        .custom-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .input-help {
            font-size: 0.8rem;
            color: #888;
            line-height: 1.4;
        }
        
        .time-display {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        .current-time {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .current-date {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .timezone-info {
            font-size: 0.9rem;
            color: #888;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .info-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .info-value {
            font-size: 1rem;
            font-weight: bold;
            color: #333;
        }
        
        .comparison-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .comparison-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 1.5rem;
        }
        
        .time-difference {
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            margin-bottom: 1.5rem;
        }
        
        .difference-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .difference-label {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .day-night-status {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .status-card {
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .day-status {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #333;
        }
        
        .night-status {
            background: linear-gradient(45deg, #2C3E50, #34495E);
            color: white;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .instructions h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .instructions ol {
            padding-left: 1.5rem;
            line-height: 1.8;
            color: #555;
        }
        
        .instructions li {
            margin-bottom: 0.8rem;
        }
        
        .faq {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .faq h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .faq-item {
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }
        
        .faq-question {
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .faq-answer {
            color: #666;
            line-height: 1.6;
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 2rem;
            text-align: center;
            border-radius: 20px;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .footer p {
            color: #666;
            margin-bottom: 1rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .footer-links a:hover {
            color: #764ba2;
        }
        
        @media (max-width: 768px) {
            .nav-container {
                padding: 0 1rem;
            }
            
            .nav-links {
                gap: 1rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .current-time {
                font-size: 2rem;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .day-night-status {
                grid-template-columns: 1fr;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .sun-trajectory {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .trajectory-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 1.5rem;
        }
        
        .trajectory-section {
            margin-bottom: 2rem;
        }
        
        .section-title {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #555;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: rgba(103, 126, 234, 0.1);
            border-radius: 10px;
        }
        
        .trajectory-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }
        
        .trajectory-svg {
            max-width: 100%;
            height: auto;
        }
        
        .trajectory-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .sun-dot { background: #FFD700; }
        .moon-dot { background: #C0C0C0; }
        .noon-dot { background: #FF6B35; }
        .horizon-line { background: #8B4513; width: 20px; height: 2px; border-radius: 0; }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">ğŸ› ï¸ å°è·¯å·¥å…·ç®±</a>
            <ul class="nav-links">
                <li><a href="../index.html">é¦–é¡µ</a></li>
                <li><a href="#instructions">ä½¿ç”¨è¯´æ˜</a></li>
                <li><a href="#faq">å¸¸è§é—®é¢˜</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="header">
            <h1>ğŸŒ å…¨çƒæ—¶å·®è®¡ç®—å™¨</h1>
            <p>å®æ—¶æ˜¾ç¤ºä¸–ç•Œå„åœ°æ—¶é—´ï¼Œè½»æ¾è§£å†³æ—¶å·®é—®é¢˜</p>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <div class="main-content">
            <!-- æœ¬åœ°æ—¶é—´å¡ç‰‡ -->
            <div class="timezone-card">
                <div class="card-header">
                    <div class="card-icon local-icon">ğŸ </div>
                    <div class="card-title">æ‚¨çš„å½“å‰ä½ç½®</div>
                </div>
                <select id="localTimezone" class="timezone-select">
                    <option value="auto">è‡ªåŠ¨æ£€æµ‹ä½ç½®</option>
                    <option value="custom">è‡ªå®šä¹‰ä½ç½®</option>
                </select>
                <div id="localCustomInput" class="custom-input-container" style="display: none;">
                    <input type="text" id="localCustomTimezone" class="custom-input" placeholder="è¯·è¾“å…¥æ—¶åŒºï¼Œå¦‚ï¼šAsia/Shanghai">
                    <div class="input-help">æ ¼å¼ç¤ºä¾‹ï¼šAsia/Shanghai, America/New_York, Europe/London</div>
                </div>
                <div class="time-display">
                    <div id="localTime" class="current-time">--:--:--</div>
                    <div id="localDate" class="current-date">åŠ è½½ä¸­...</div>
                    <div id="localTimezoneInfo" class="timezone-info">æ£€æµ‹æ—¶åŒºä¸­...</div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">æ—¥å‡ºæ—¶é—´</div>
                        <div id="localSunrise" class="info-value">--:--</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ—¥è½æ—¶é—´</div>
                        <div id="localSunset" class="info-value">--:--</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å†œå†æ—¥æœŸ</div>
                        <div id="localLunar" class="info-value">è®¡ç®—ä¸­...</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ˜ŸæœŸ</div>
                        <div id="localWeekday" class="info-value">--</div>
                    </div>
                </div>
            </div>

            <!-- ç›®æ ‡æ—¶é—´å¡ç‰‡ -->
            <div class="timezone-card">
                <div class="card-header">
                    <div class="card-icon target-icon">ğŸ¯</div>
                    <div class="card-title">ç›®æ ‡åœ°åŒº</div>
                </div>
                <select id="targetTimezone" class="timezone-select">
                    <option value="">è¯·é€‰æ‹©ç›®æ ‡åœ°åŒº</option>
                    <option value="custom">è‡ªå®šä¹‰ä½ç½®</option>
                </select>
                <div id="targetCustomInput" class="custom-input-container" style="display: none;">
                    <input type="text" id="targetCustomTimezone" class="custom-input" placeholder="è¯·è¾“å…¥æ—¶åŒºï¼Œå¦‚ï¼šAsia/Tokyo">
                    <div class="input-help">æ ¼å¼ç¤ºä¾‹ï¼šAsia/Tokyo, America/Los_Angeles, Europe/Paris</div>
                </div>
                <div class="time-display">
                    <div id="targetTime" class="current-time">--:--:--</div>
                    <div id="targetDate" class="current-date">è¯·é€‰æ‹©åœ°åŒº</div>
                    <div id="targetTimezoneInfo" class="timezone-info">--</div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">æ—¥å‡ºæ—¶é—´</div>
                        <div id="targetSunrise" class="info-value">--:--</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ—¥è½æ—¶é—´</div>
                        <div id="targetSunset" class="info-value">--:--</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å†œå†æ—¥æœŸ</div>
                        <div id="targetLunar" class="info-value">--</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ˜ŸæœŸ</div>
                        <div id="targetWeekday" class="info-value">--</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ—¶å·®å¯¹æ¯”åŒºåŸŸ -->
        <div class="comparison-section">
            <h3 class="comparison-title">æ—¶å·®å¯¹æ¯”åˆ†æ</h3>
            <div class="time-difference">
                <div id="timeDifference" class="difference-value">è¯·é€‰æ‹©ç›®æ ‡åœ°åŒº</div>
                <div class="difference-label">æ—¶é—´å·®</div>
            </div>
            <div class="day-night-status">
                <div id="localDayNight" class="status-card day-status">
                    <div>æ‚¨çš„ä½ç½®</div>
                    <div>æ£€æµ‹ä¸­...</div>
                </div>
                <div id="targetDayNight" class="status-card night-status">
                    <div>ç›®æ ‡åœ°åŒº</div>
                    <div>è¯·é€‰æ‹©åœ°åŒº</div>
                </div>
            </div>
        </div>

        <!-- å¤ªé˜³è½¨è¿¹å¯è§†åŒ– -->
        <div class="sun-trajectory">
            <h3 class="trajectory-title">ğŸŒ… å¤ªé˜³æœˆäº®è½¨è¿¹å¯¹æ¯”å›¾</h3>
            
            <!-- å½“å‰åœ°åŒºè½¨è¿¹ -->
            <div class="trajectory-section">
                <h4 class="section-title">ğŸ“ å½“å‰åœ°åŒº</h4>
                <div class="trajectory-container">
                    <svg id="localTrajectoryChart" class="trajectory-svg" width="500" height="300" viewBox="0 0 500 300">
                        <!-- èƒŒæ™¯æ¸å˜ -->
                        <defs>
                            <linearGradient id="localSkyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#87CEEB;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#E0F6FF;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="localGroundGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#8B4513;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#A0522D;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        
                        <!-- å¤©ç©ºèƒŒæ™¯ -->
                        <rect x="0" y="0" width="500" height="200" fill="url(#localSkyGradient)" />
                        
                        <!-- åœ°é¢ -->
                        <rect x="0" y="200" width="500" height="100" fill="url(#localGroundGradient)" />
                        
                        <!-- åœ°å¹³çº¿ -->
                        <line x1="0" y1="200" x2="500" y2="200" stroke="#654321" stroke-width="2" />
                        
                        <!-- å¤ªé˜³è½¨è¿¹å¼§çº¿ -->
                        <path d="M 50 200 Q 250 50 450 200" stroke="#FFD700" stroke-width="3" fill="none" stroke-dasharray="5,5" opacity="0.7" />
                        
                        <!-- æœˆäº®è½¨è¿¹å¼§çº¿ -->
                        <path d="M 50 200 Q 250 80 450 200" stroke="#C0C0C0" stroke-width="2" fill="none" stroke-dasharray="3,3" opacity="0.5" />
                        
                        <!-- æ–¹å‘æ ‡è¯† -->
                        <text x="30" y="220" font-family="Arial" font-size="14" fill="#333">ä¸œ</text>
                        <text x="460" y="220" font-family="Arial" font-size="14" fill="#333">è¥¿</text>
                        <text x="240" y="240" font-family="Arial" font-size="14" fill="#333">å—</text>
                        
                        <!-- åŠ¨æ€å…ƒç´  -->
                        <g id="localDynamicElements"></g>
                    </svg>
                </div>
            </div>
            
            <!-- ç›®æ ‡åœ°åŒºè½¨è¿¹ -->
            <div class="trajectory-section">
                <h4 class="section-title">ğŸ¯ ç›®æ ‡åœ°åŒº</h4>
                <div class="trajectory-container">
                    <svg id="targetTrajectoryChart" class="trajectory-svg" width="500" height="300" viewBox="0 0 500 300">
                        <!-- èƒŒæ™¯æ¸å˜ -->
                        <defs>
                            <linearGradient id="targetSkyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#B8E6FF;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="targetGroundGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#6B4423;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#8B5A2B;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        
                        <!-- å¤©ç©ºèƒŒæ™¯ -->
                        <rect x="0" y="0" width="500" height="200" fill="url(#targetSkyGradient)" />
                        
                        <!-- åœ°é¢ -->
                        <rect x="0" y="200" width="500" height="100" fill="url(#targetGroundGradient)" />
                        
                        <!-- åœ°å¹³çº¿ -->
                        <line x1="0" y1="200" x2="500" y2="200" stroke="#543A1A" stroke-width="2" />
                        
                        <!-- å¤ªé˜³è½¨è¿¹å¼§çº¿ -->
                        <path d="M 50 200 Q 250 50 450 200" stroke="#FFD700" stroke-width="3" fill="none" stroke-dasharray="5,5" opacity="0.7" />
                        
                        <!-- æœˆäº®è½¨è¿¹å¼§çº¿ -->
                        <path d="M 50 200 Q 250 80 450 200" stroke="#C0C0C0" stroke-width="2" fill="none" stroke-dasharray="3,3" opacity="0.5" />
                        
                        <!-- æ–¹å‘æ ‡è¯† -->
                        <text x="30" y="220" font-family="Arial" font-size="14" fill="#333">ä¸œ</text>
                        <text x="460" y="220" font-family="Arial" font-size="14" fill="#333">è¥¿</text>
                        <text x="240" y="240" font-family="Arial" font-size="14" fill="#333">å—</text>
                        
                        <!-- åŠ¨æ€å…ƒç´  -->
                        <g id="targetDynamicElements"></g>
                    </svg>
                </div>
            </div>
            
            <div class="trajectory-legend">
                <div class="legend-item">
                    <div class="legend-dot sun-dot"></div>
                    <span>å¤ªé˜³è½¨è¿¹</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot moon-dot"></div>
                    <span>æœˆäº®è½¨è¿¹</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot noon-dot"></div>
                    <span>æ­£åˆæ—¶åˆ»</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot horizon-line"></div>
                    <span>åœ°å¹³çº¿</span>
                </div>
            </div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div id="instructions" class="instructions">
            <h2>ğŸ“– ä½¿ç”¨è¯´æ˜</h2>
            <ol>
                <li><strong>è‡ªåŠ¨æ£€æµ‹ä½ç½®ï¼š</strong>å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹æ‚¨çš„å½“å‰æ—¶åŒºå’Œä½ç½®ï¼Œæ˜¾ç¤ºæœ¬åœ°æ—¶é—´ã€æ—¥å‡ºæ—¥è½ç­‰ä¿¡æ¯</li>
                <li><strong>é€‰æ‹©ç›®æ ‡åœ°åŒºï¼š</strong>åœ¨å³ä¾§ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©æ‚¨æƒ³è¦å¯¹æ¯”çš„ç›®æ ‡åœ°åŒºï¼Œæˆ–é€‰æ‹©"è‡ªå®šä¹‰ä½ç½®"æ‰‹åŠ¨è¾“å…¥æ—¶åŒº</li>
                <li><strong>æŸ¥çœ‹æ—¶å·®ï¼š</strong>ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—å¹¶æ˜¾ç¤ºä¸¤åœ°çš„æ—¶é—´å·®ï¼Œä»¥åŠå½“å‰æ˜¯ç™½å¤©è¿˜æ˜¯å¤œæ™š</li>
                <li><strong>æ—¥å‡ºæ—¥è½æ—¶é—´ï¼š</strong>æ˜¾ç¤ºä¸¤åœ°çš„æ—¥å‡ºæ—¥è½æ—¶é—´ï¼Œå¸®åŠ©æ‚¨äº†è§£å½“åœ°çš„æ˜¼å¤œæƒ…å†µ</li>
                <li><strong>å†œå†ä¿¡æ¯ï¼š</strong>åŒæ—¶æ˜¾ç¤ºå…¬å†å’Œå†œå†æ—¥æœŸï¼Œæ–¹ä¾¿ä¸­æ–‡ç”¨æˆ·æŸ¥çœ‹</li>
                <li><strong>è‡ªå®šä¹‰æ—¶åŒºï¼š</strong>æ”¯æŒæ‰‹åŠ¨è¾“å…¥ä»»æ„æœ‰æ•ˆçš„æ—¶åŒºæ ‡è¯†ç¬¦ï¼Œå¦‚Asia/Shanghaiã€America/New_Yorkç­‰</li>
                <li><strong>å®æ—¶æ›´æ–°ï¼š</strong>æ—¶é—´ä¿¡æ¯æ¯ç§’è‡ªåŠ¨æ›´æ–°ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®æ€§</li>
            </ol>
        </div>

        <!-- å¸¸è§é—®é¢˜ -->
        <div id="faq" class="faq">
            <h2>â“ å¸¸è§é—®é¢˜</h2>
            <div class="faq-item">
                <div class="faq-question">Q: ä¸ºä»€ä¹ˆæ— æ³•è‡ªåŠ¨æ£€æµ‹æˆ‘çš„ä½ç½®ï¼Ÿ</div>
                <div class="faq-answer">A: è¯·ç¡®ä¿æ‚¨çš„æµè§ˆå™¨å…è®¸è·å–ä½ç½®ä¿¡æ¯ï¼Œæˆ–è€…æ‰‹åŠ¨åœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©æ‚¨çš„æ—¶åŒºã€‚</div>
            </div>
            <div class="faq-item">
                <div class="faq-question">Q: æ—¥å‡ºæ—¥è½æ—¶é—´å‡†ç¡®å—ï¼Ÿ</div>
                <div class="faq-answer">A: æ—¥å‡ºæ—¥è½æ—¶é—´åŸºäºåœ°ç†ä½ç½®è®¡ç®—ï¼Œç²¾åº¦åœ¨å‡ åˆ†é’Ÿå†…ï¼Œé€‚ç”¨äºä¸€èˆ¬æ—¶å·®å‚è€ƒã€‚</div>
            </div>
            <div class="faq-item">
                <div class="faq-question">Q: å†œå†æ—¥æœŸæ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ</div>
                <div class="faq-answer">A: å†œå†æ—¥æœŸåŸºäºä¸­å›½ä¼ ç»Ÿå†æ³•è®¡ç®—ï¼ŒåŒ…å«å¹´ä»½ã€æœˆä»½å’Œæ—¥æœŸä¿¡æ¯ã€‚</div>
            </div>
            <div class="faq-item">
                <div class="faq-question">Q: æ—¶å·®è®¡ç®—è€ƒè™‘å¤ä»¤æ—¶å—ï¼Ÿ</div>
                <div class="faq-answer">A: æ˜¯çš„ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è€ƒè™‘å„åœ°çš„å¤ä»¤æ—¶è§„åˆ™ï¼Œç¡®ä¿æ—¶å·®è®¡ç®—å‡†ç¡®ã€‚</div>
            </div>
            <div class="faq-item">
                <div class="faq-question">Q: æ”¯æŒå“ªäº›åœ°åŒºå’Œæ—¶åŒºï¼Ÿ</div>
                <div class="faq-answer">A: æ”¯æŒå…¨çƒæ‰€æœ‰ä¸»è¦åŸå¸‚å’Œæ—¶åŒºï¼ŒåŒ…æ‹¬å„å¤§æ´²çš„é‡è¦åŸå¸‚å’Œåœ°åŒºã€‚åŒæ—¶æ”¯æŒè‡ªå®šä¹‰è¾“å…¥ä»»æ„æœ‰æ•ˆçš„æ—¶åŒºæ ‡è¯†ç¬¦ã€‚</div>
            </div>
            <div class="faq-item">
                <div class="faq-question">Q: å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æ—¶åŒºåŠŸèƒ½ï¼Ÿ</div>
                <div class="faq-answer">A: é€‰æ‹©"è‡ªå®šä¹‰ä½ç½®"é€‰é¡¹ï¼Œç„¶åè¾“å…¥æ ‡å‡†çš„æ—¶åŒºæ ‡è¯†ç¬¦ï¼Œå¦‚Asia/Shanghaiï¼ˆä¸Šæµ·ï¼‰ã€America/New_Yorkï¼ˆçº½çº¦ï¼‰ã€Europe/Londonï¼ˆä¼¦æ•¦ï¼‰ç­‰ã€‚</div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <div class="footer">
            <p>Â© 2025 å…¨çƒæ—¶å·®è®¡ç®—å™¨ - ä¸“ä¸šçš„æ—¶å·®å¯¹æ¯”å·¥å…·ï¼Œæ”¯æŒå…¨çƒæ—¶åŒºæŸ¥è¯¢å’Œæ—¥å‡ºæ—¥è½æ—¶é—´è®¡ç®—</p>
            <div class="footer-links">
                <a href="https://t.zsxq.com/17wTksRxX" target="_blank" style="color: #667eea; text-decoration: none; font-weight: 500;">æŠ€æœ¯æ”¯æŒ</a>
                <a href="https://t.zsxq.com/17wTksRxX" target="_blank" style="color: #667eea; text-decoration: none; font-weight: 500;">é—®é¢˜åé¦ˆ</a>
            </div>
        </div>
    </div>

    <script>
        // å…¨çƒä¸»è¦åŸå¸‚æ—¶åŒºæ•°æ®
        const timezones = [
            { value: 'Asia/Shanghai', label: 'ä¸­å›½ - åŒ—äº¬/ä¸Šæµ·', coords: [39.9042, 116.4074] },
            { value: 'Asia/Hong_Kong', label: 'ä¸­å›½ - é¦™æ¸¯', coords: [22.3193, 114.1694] },
            { value: 'Asia/Taipei', label: 'ä¸­å›½ - å°åŒ—', coords: [25.0330, 121.5654] },
            { value: 'Asia/Tokyo', label: 'æ—¥æœ¬ - ä¸œäº¬', coords: [35.6762, 139.6503] },
            { value: 'Asia/Seoul', label: 'éŸ©å›½ - é¦–å°”', coords: [37.5665, 126.9780] },
            { value: 'Asia/Singapore', label: 'æ–°åŠ å¡', coords: [1.3521, 103.8198] },
            { value: 'Asia/Bangkok', label: 'æ³°å›½ - æ›¼è°·', coords: [13.7563, 100.5018] },
            { value: 'Asia/Dubai', label: 'é˜¿è”é…‹ - è¿ªæ‹œ', coords: [25.2048, 55.2708] },
            { value: 'Europe/London', label: 'è‹±å›½ - ä¼¦æ•¦', coords: [51.5074, -0.1278] },
            { value: 'Europe/Paris', label: 'æ³•å›½ - å·´é»', coords: [48.8566, 2.3522] },
            { value: 'Europe/Berlin', label: 'å¾·å›½ - æŸæ—', coords: [52.5200, 13.4050] },
            { value: 'Europe/Rome', label: 'æ„å¤§åˆ© - ç½—é©¬', coords: [41.9028, 12.4964] },
            { value: 'Europe/Moscow', label: 'ä¿„ç½—æ–¯ - è«æ–¯ç§‘', coords: [55.7558, 37.6176] },
            { value: 'America/New_York', label: 'ç¾å›½ - çº½çº¦', coords: [40.7128, -74.0060] },
            { value: 'America/Los_Angeles', label: 'ç¾å›½ - æ´›æ‰çŸ¶', coords: [34.0522, -118.2437] },
            { value: 'America/Chicago', label: 'ç¾å›½ - èŠåŠ å“¥', coords: [41.8781, -87.6298] },
            { value: 'America/Toronto', label: 'åŠ æ‹¿å¤§ - å¤šä¼¦å¤š', coords: [43.6532, -79.3832] },
            { value: 'America/Sao_Paulo', label: 'å·´è¥¿ - åœ£ä¿ç½—', coords: [-23.5505, -46.6333] },
            { value: 'Australia/Sydney', label: 'æ¾³å¤§åˆ©äºš - æ‚‰å°¼', coords: [-33.8688, 151.2093] },
            { value: 'Australia/Melbourne', label: 'æ¾³å¤§åˆ©äºš - å¢¨å°”æœ¬', coords: [-37.8136, 144.9631] },
            { value: 'Pacific/Auckland', label: 'æ–°è¥¿å…° - å¥¥å…‹å…°', coords: [-36.8485, 174.7633] }
        ];

        let localCoords = null;
        let targetCoords = null;
        let updateInterval = null;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeTimezones();
            detectUserLocation();
            startTimeUpdates();
        });

        // åˆå§‹åŒ–æ—¶åŒºé€‰æ‹©å™¨
        function initializeTimezones() {
            const localSelect = document.getElementById('localTimezone');
            const targetSelect = document.getElementById('targetTimezone');

            // æ·»åŠ æ—¶åŒºé€‰é¡¹åˆ°æœ¬åœ°æ—¶åŒºé€‰æ‹©å™¨
            timezones.forEach(tz => {
                const option = document.createElement('option');
                option.value = tz.value;
                option.textContent = tz.label;
                localSelect.appendChild(option.cloneNode(true));
                targetSelect.appendChild(option);
            });

            // ç›‘å¬é€‰æ‹©å˜åŒ–
            localSelect.addEventListener('change', handleLocalTimezoneChange);
            targetSelect.addEventListener('change', handleTargetTimezoneChange);
        }

        // æ£€æµ‹ç”¨æˆ·ä½ç½®
        function detectUserLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        localCoords = [position.coords.latitude, position.coords.longitude];
                        // è·å–ç”¨æˆ·å½“å‰æ—¶åŒº
                        const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                        // å¦‚æœå½“å‰é€‰æ‹©æ˜¯è‡ªåŠ¨æ£€ç´¢ï¼Œä¿æŒautoçŠ¶æ€ï¼Œä½†ç¡®ä¿åæ ‡å’Œæ—¶åŒºéƒ½æ­£ç¡®
                        const select = document.getElementById('localTimezone');
                        if (select.value === 'auto') {
                            // ä¿æŒautoé€‰æ‹©ï¼Œä½†ç«‹å³æ›´æ–°æ˜¾ç¤ºå’Œè½¨è¿¹å›¾
                            updateLocalTime();
                            // å¼ºåˆ¶æ›´æ–°è½¨è¿¹å›¾ï¼Œç¡®ä¿ä½¿ç”¨æ–°çš„åæ ‡
                            const timezone = getCurrentTimezone(true);
                            if (timezone && isValidTimezone(timezone)) {
                                updateSunTimes('local', localCoords, timezone);
                                updateDayNightStatus('localDayNight', localCoords, timezone);
                            }
                        } else {
                            // å¦‚æœä¸æ˜¯autoçŠ¶æ€ï¼Œè®¾ç½®ä¸ºæ£€æµ‹åˆ°çš„æ—¶åŒº
                            select.value = userTimezone;
                            updateLocalTime();
                        }
                    },
                    error => {
                        console.log('ä½ç½®æ£€æµ‹å¤±è´¥:', error);
                        // é»˜è®¤ä½¿ç”¨åŒ—äº¬æ—¶é—´
                        document.getElementById('localTimezone').value = 'Asia/Shanghai';
                        localCoords = [39.9042, 116.4074];
                        updateLocalTime();
                    }
                );
            } else {
                // æµè§ˆå™¨ä¸æ”¯æŒåœ°ç†ä½ç½®ï¼Œä½¿ç”¨é»˜è®¤
                document.getElementById('localTimezone').value = 'Asia/Shanghai';
                localCoords = [39.9042, 116.4074];
                updateLocalTime();
            }
        }

        // å¤„ç†æœ¬åœ°æ—¶åŒºå˜åŒ–
        function handleLocalTimezoneChange() {
            const select = document.getElementById('localTimezone');
            const customContainer = document.getElementById('localCustomInput');
            
            if (select.value === 'auto') {
                customContainer.style.display = 'none';
                detectUserLocation();
            } else if (select.value === 'custom') {
                customContainer.style.display = 'block';
                setupCustomTimezoneInput('localCustomTimezone', updateLocalTime);
            } else {
                customContainer.style.display = 'none';
                const timezone = timezones.find(tz => tz.value === select.value);
                if (timezone) {
                    localCoords = timezone.coords;
                    updateLocalTime();
                }
            }
        }

        // å¤„ç†ç›®æ ‡æ—¶åŒºå˜åŒ–
        function handleTargetTimezoneChange() {
            const select = document.getElementById('targetTimezone');
            const customContainer = document.getElementById('targetCustomInput');
            
            if (select.value === 'custom') {
                customContainer.style.display = 'block';
                setupCustomTimezoneInput('targetCustomTimezone', () => {
                    updateTargetTime();
                    updateComparison();
                });
            } else if (select.value) {
                customContainer.style.display = 'none';
                const timezone = timezones.find(tz => tz.value === select.value);
                if (timezone) {
                    targetCoords = timezone.coords;
                    updateTargetTime();
                    updateComparison();
                }
            } else {
                customContainer.style.display = 'none';
            }
        }

        // å¼€å§‹æ—¶é—´æ›´æ–°
        function startTimeUpdates() {
            updateInterval = setInterval(() => {
                updateLocalTime();
                updateTargetTime();
                updateComparison();
            }, 1000);
        }

        // æ›´æ–°æœ¬åœ°æ—¶é—´
        function updateLocalTime() {
            const timezone = getCurrentTimezone(true);
            
            if (!timezone || !isValidTimezone(timezone)) return;

            const now = new Date();
            
            // æ›´æ–°æ—¶é—´æ˜¾ç¤º
            document.getElementById('localTime').textContent = 
                now.toLocaleTimeString('zh-CN', { timeZone: timezone, hour12: false });
            
            // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
            const dateStr = now.toLocaleDateString('zh-CN', { 
                timeZone: timezone,
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('localDate').textContent = dateStr;
            
            // æ›´æ–°æ—¶åŒºä¿¡æ¯
            const offset = getTimezoneOffset(timezone);
            document.getElementById('localTimezoneInfo').textContent = 
                `${timezone} (UTC${offset})`;
            
            // æ›´æ–°æ˜ŸæœŸ
            const weekday = now.toLocaleDateString('zh-CN', { 
                timeZone: timezone,
                weekday: 'long'
            });
            document.getElementById('localWeekday').textContent = weekday;
            
            // æ›´æ–°å†œå†
            updateLunarDate('localLunar', now);
            
            // æ›´æ–°æ—¥å‡ºæ—¥è½
            if (localCoords) {
                updateSunTimes('local', localCoords, timezone);
                updateDayNightStatus('localDayNight', localCoords, timezone);
            }
        }

        // æ›´æ–°ç›®æ ‡æ—¶é—´
        function updateTargetTime() {
            const timezone = getCurrentTimezone(false);
            
            if (!timezone || !isValidTimezone(timezone)) return;

            const now = new Date();
            
            // æ›´æ–°æ—¶é—´æ˜¾ç¤º
            document.getElementById('targetTime').textContent = 
                now.toLocaleTimeString('zh-CN', { timeZone: timezone, hour12: false });
            
            // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
            const dateStr = now.toLocaleDateString('zh-CN', { 
                timeZone: timezone,
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('targetDate').textContent = dateStr;
            
            // æ›´æ–°æ—¶åŒºä¿¡æ¯
            const offset = getTimezoneOffset(timezone);
            document.getElementById('targetTimezoneInfo').textContent = 
                `${timezone} (UTC${offset})`;
            
            // æ›´æ–°æ˜ŸæœŸ
            const weekday = now.toLocaleDateString('zh-CN', { 
                timeZone: timezone,
                weekday: 'long'
            });
            document.getElementById('targetWeekday').textContent = weekday;
            
            // æ›´æ–°å†œå†
            updateLunarDate('targetLunar', now);
            
            // æ›´æ–°æ—¥å‡ºæ—¥è½
            if (targetCoords) {
                updateSunTimes('target', targetCoords, timezone);
                updateDayNightStatus('targetDayNight', targetCoords, timezone);
            }
        }

        // è·å–æ—¶åŒºåç§»
        function getTimezoneOffset(timezone) {
            const now = new Date();
            const utc = new Date(now.getTime() + (now.getTimezoneOffset() * 60000));
            const target = new Date(utc.toLocaleString('en-US', { timeZone: timezone }));
            const diff = (target.getTime() - utc.getTime()) / (1000 * 60 * 60);
            return diff >= 0 ? `+${diff}` : `${diff}`;
        }

        // æ›´æ–°å†œå†æ—¥æœŸï¼ˆç®€åŒ–ç‰ˆï¼‰
        function updateLunarDate(elementId, date) {
            // è¿™é‡Œä½¿ç”¨ç®€åŒ–çš„å†œå†è®¡ç®—ï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥ä½¿ç”¨æ›´ç²¾ç¡®çš„å†œå†åº“
            const lunarMonths = ['æ­£æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 
                                'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'åä¸€æœˆ', 'åäºŒæœˆ'];
            const lunarDays = ['åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
                              'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
                              'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'];
            
            // ç®€åŒ–è®¡ç®—ï¼ˆå®é™…éœ€è¦å¤æ‚çš„å†œå†ç®—æ³•ï¼‰
            const month = date.getMonth();
            const day = date.getDate();
            const lunarMonth = lunarMonths[month % 12];
            const lunarDay = lunarDays[(day - 1) % 30];
            
            document.getElementById(elementId).textContent = `${lunarMonth}${lunarDay}`;
        }

        // æ›´æ–°æ—¥å‡ºæ—¥è½æ—¶é—´
        function updateSunTimes(prefix, coords, timezone) {
            const [lat, lng] = coords;
            const now = new Date();
            
            // ç®€åŒ–çš„æ—¥å‡ºæ—¥è½è®¡ç®—ï¼ˆå®é™…åº”ç”¨ä¸­å»ºè®®ä½¿ç”¨ä¸“ä¸šçš„å¤©æ–‡è®¡ç®—åº“ï¼‰
            const dayOfYear = Math.floor((now - new Date(now.getFullYear(), 0, 0)) / 86400000);
            const solarDeclination = 23.45 * Math.sin((360 * (284 + dayOfYear) / 365) * Math.PI / 180);
            const hourAngle = Math.acos(-Math.tan(lat * Math.PI / 180) * Math.tan(solarDeclination * Math.PI / 180));
            
            const sunrise = 12 - (hourAngle * 180 / Math.PI) / 15;
            const sunset = 12 + (hourAngle * 180 / Math.PI) / 15;
            
            // è®¡ç®—çœŸå®çš„å¤ªé˜³æ­£åˆæ—¶é—´ï¼ˆå¤ªé˜³æœ€é«˜ç‚¹ï¼‰
            // è€ƒè™‘ç»åº¦å’Œæ—¶åŒºå¯¹æ­£åˆæ—¶é—´çš„å½±å“
            const timezoneOffset = getTimezoneOffset(timezone);
            const longitudeOffset = lng / 15; // ç»åº¦åç§»å°æ—¶æ•°
            // å¤ªé˜³æ­£åˆ = 12ç‚¹ - æ—¶åŒºåç§» + ç»åº¦åç§»
            const noon = 12 - parseFloat(timezoneOffset) + longitudeOffset;
            // ç¡®ä¿æ­£åˆæ—¶é—´åœ¨åˆç†èŒƒå›´å†…ï¼ˆ10-14ç‚¹ä¹‹é—´ï¼‰
            const adjustedNoon = Math.max(10, Math.min(14, noon));
            
            // ç®€åŒ–çš„æœˆå‡ºæœˆè½è®¡ç®—ï¼ˆæœˆäº®è½¨è¿¹é€šå¸¸ä¸å¤ªé˜³ç›¸å·®çº¦12å°æ—¶ï¼‰
            const moonrise = (sunrise + 12) % 24;
            const moonset = (sunset + 12) % 24;
            
            const formatTime = (hours) => {
                const h = Math.floor(hours);
                const m = Math.floor((hours - h) * 60);
                return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
            };
            
            document.getElementById(`${prefix}Sunrise`).textContent = formatTime(sunrise);
            document.getElementById(`${prefix}Sunset`).textContent = formatTime(sunset);
            
            // æ›´æ–°è½¨è¿¹å›¾
            updateTrajectoryChart(prefix, sunrise, sunset, adjustedNoon, moonrise, moonset, coords, timezone);
        }

        // æ›´æ–°æ˜¼å¤œçŠ¶æ€
        function updateDayNightStatus(elementId, coords, timezone) {
            const now = new Date();
            const hours = now.getHours();
            
            // ç®€åŒ–åˆ¤æ–­ï¼š6-18ç‚¹ä¸ºç™½å¤©ï¼Œå…¶ä»–ä¸ºå¤œæ™š
            const isDay = hours >= 6 && hours < 18;
            const element = document.getElementById(elementId);
            
            if (isDay) {
                element.className = 'status-card day-status';
                element.innerHTML = `<div>${elementId.includes('local') ? 'æ‚¨çš„ä½ç½®' : 'ç›®æ ‡åœ°åŒº'}</div><div>â˜€ï¸ ç™½å¤©</div>`;
            } else {
                element.className = 'status-card night-status';
                element.innerHTML = `<div>${elementId.includes('local') ? 'æ‚¨çš„ä½ç½®' : 'ç›®æ ‡åœ°åŒº'}</div><div>ğŸŒ™ å¤œæ™š</div>`;
            }
        }

        // è®¾ç½®è‡ªå®šä¹‰æ—¶åŒºè¾“å…¥
        function setupCustomTimezoneInput(inputId, callback) {
            const input = document.getElementById(inputId);
            input.addEventListener('input', function() {
                const timezone = this.value.trim();
                if (timezone && isValidTimezone(timezone)) {
                    // ä½¿ç”¨é»˜è®¤åæ ‡ï¼ˆåŒ—äº¬ï¼‰ä½œä¸ºå ä½ç¬¦
                    if (inputId === 'localCustomTimezone') {
                        localCoords = [39.9042, 116.4074];
                    } else {
                        targetCoords = [39.9042, 116.4074];
                    }
                    callback();
                }
            });
        }
        
        // éªŒè¯æ—¶åŒºæ ¼å¼
        function isValidTimezone(timezone) {
            try {
                Intl.DateTimeFormat(undefined, { timeZone: timezone });
                return true;
            } catch (e) {
                return false;
            }
        }
        
        // è·å–å½“å‰ä½¿ç”¨çš„æ—¶åŒº
        function getCurrentTimezone(isLocal = true) {
            if (isLocal) {
                const localSelect = document.getElementById('localTimezone');
                if (localSelect.value === 'auto') {
                    return Intl.DateTimeFormat().resolvedOptions().timeZone;
                } else if (localSelect.value === 'custom') {
                    return document.getElementById('localCustomTimezone').value.trim();
                } else {
                    return localSelect.value;
                }
            } else {
                const targetSelect = document.getElementById('targetTimezone');
                if (targetSelect.value === 'custom') {
                    return document.getElementById('targetCustomTimezone').value.trim();
                } else {
                    return targetSelect.value;
                }
            }
        }
        
        // æ›´æ–°æ—¶å·®å¯¹æ¯”
        function updateComparison() {
            const localTimezone = getCurrentTimezone(true);
            const targetTimezone = getCurrentTimezone(false);
            
            if (!targetTimezone || !isValidTimezone(targetTimezone)) return;
            
            try {
                const now = new Date();
                const localTime = new Date(now.toLocaleString('en-US', { timeZone: localTimezone }));
                const targetTime = new Date(now.toLocaleString('en-US', { timeZone: targetTimezone }));
                
                const diffMs = targetTime.getTime() - localTime.getTime();
                const diffHours = Math.round(diffMs / (1000 * 60 * 60));
                
                let diffText;
                if (diffHours === 0) {
                    diffText = 'æ— æ—¶å·®';
                } else if (diffHours > 0) {
                    diffText = `å¿« ${diffHours} å°æ—¶`;
                } else {
                    diffText = `æ…¢ ${Math.abs(diffHours)} å°æ—¶`;
                }
                
                document.getElementById('timeDifference').textContent = diffText;
            } catch (e) {
                 document.getElementById('timeDifference').textContent = 'æ—¶åŒºæ ¼å¼é”™è¯¯';
             }
         }
         
         // æ›´æ–°è½¨è¿¹å›¾
         function updateTrajectoryChart(prefix, sunrise, sunset, noon, moonrise, moonset, coords, timezone) {
             const chartId = prefix === 'local' ? 'localDynamicElements' : 'targetDynamicElements';
             const dynamicElements = document.getElementById(chartId);
             if (!dynamicElements) return;
             
             dynamicElements.innerHTML = ''; // æ¸…ç©ºä¹‹å‰çš„å…ƒç´ 
             
             const now = new Date();
             let currentHour;
             
             // æ ¹æ®æ—¶åŒºè®¡ç®—å½“å‰æ—¶é—´
             try {
                 if (prefix === 'local') {
                     const localTimezone = getCurrentTimezone(true);
                     const localTime = new Date(now.toLocaleString('en-US', { timeZone: localTimezone }));
                     currentHour = localTime.getHours() + localTime.getMinutes() / 60;
                 } else {
                     const targetTimezone = getCurrentTimezone(false);
                     if (targetTimezone && isValidTimezone(targetTimezone)) {
                         const targetTime = new Date(now.toLocaleString('en-US', { timeZone: targetTimezone }));
                         currentHour = targetTime.getHours() + targetTime.getMinutes() / 60;
                     } else {
                         currentHour = now.getHours() + now.getMinutes() / 60;
                     }
                 }
             } catch (e) {
                 currentHour = now.getHours() + now.getMinutes() / 60;
             }
             
             // è®¡ç®—ä½ç½®ï¼ˆåŸºäº12å°æ—¶åˆ¶ï¼Œ6ç‚¹ä¸ºä¸œæ–¹èµ·ç‚¹ï¼Œ18ç‚¹ä¸ºè¥¿æ–¹ç»ˆç‚¹ï¼‰
             const calculatePosition = (timeInHours) => {
                 // å°†æ—¶é—´æ˜ å°„åˆ°0-1çš„èŒƒå›´ï¼ˆ6ç‚¹åˆ°18ç‚¹ï¼‰
                 const normalizedTime = Math.max(0, Math.min(1, (timeInHours - 6) / 12));
                 const x = 50 + normalizedTime * 400; // Xåæ ‡ä»50åˆ°450
                 
                 // ä½¿ç”¨æŠ›ç‰©çº¿è®¡ç®—Yåæ ‡ï¼ˆæ¨¡æ‹Ÿå¤ªé˜³å¼§çº¿ï¼‰
                 const y = 200 - 150 * Math.sin(normalizedTime * Math.PI);
                 return { x, y };
             };
             
             const formatTimeLabel = (hours) => {
                 const h = Math.floor(hours);
                 const m = Math.floor((hours % 1) * 60);
                 return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
             };
             
             // ç»˜åˆ¶æ—¥å‡ºç‚¹
             const sunrisePos = calculatePosition(sunrise);
             const sunriseCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
             sunriseCircle.setAttribute('cx', sunrisePos.x);
             sunriseCircle.setAttribute('cy', sunrisePos.y);
             sunriseCircle.setAttribute('r', '6');
             sunriseCircle.setAttribute('fill', '#FF6B35');
             sunriseCircle.setAttribute('stroke', '#FF4500');
             sunriseCircle.setAttribute('stroke-width', '2');
             dynamicElements.appendChild(sunriseCircle);
             
             // æ—¥å‡ºæ ‡ç­¾
             const sunriseText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
             sunriseText.setAttribute('x', sunrisePos.x);
             sunriseText.setAttribute('y', sunrisePos.y - 15);
             sunriseText.setAttribute('text-anchor', 'middle');
             sunriseText.setAttribute('font-family', 'Arial');
             sunriseText.setAttribute('font-size', '11');
             sunriseText.setAttribute('fill', '#333');
             sunriseText.setAttribute('font-weight', 'bold');
             sunriseText.textContent = `æ—¥å‡º ${formatTimeLabel(sunrise)}`;
             dynamicElements.appendChild(sunriseText);
             
             // ç»˜åˆ¶æ­£åˆç‚¹
             const noonPos = calculatePosition(noon);
             const noonCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
             noonCircle.setAttribute('cx', noonPos.x);
             noonCircle.setAttribute('cy', noonPos.y);
             noonCircle.setAttribute('r', '8');
             noonCircle.setAttribute('fill', '#FFD700');
             noonCircle.setAttribute('stroke', '#FFA500');
             noonCircle.setAttribute('stroke-width', '2');
             dynamicElements.appendChild(noonCircle);
             
             // æ­£åˆæ ‡ç­¾
             const noonText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
             noonText.setAttribute('x', noonPos.x);
             noonText.setAttribute('y', noonPos.y - 15);
             noonText.setAttribute('text-anchor', 'middle');
             noonText.setAttribute('font-family', 'Arial');
             noonText.setAttribute('font-size', '11');
             noonText.setAttribute('fill', '#333');
             noonText.setAttribute('font-weight', 'bold');
             noonText.textContent = `æ­£åˆ ${formatTimeLabel(noon)}`;
             dynamicElements.appendChild(noonText);
             
             // ç»˜åˆ¶æ—¥è½ç‚¹
             const sunsetPos = calculatePosition(sunset);
             const sunsetCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
             sunsetCircle.setAttribute('cx', sunsetPos.x);
             sunsetCircle.setAttribute('cy', sunsetPos.y);
             sunsetCircle.setAttribute('r', '6');
             sunsetCircle.setAttribute('fill', '#FF4500');
             sunsetCircle.setAttribute('stroke', '#FF6B35');
             sunsetCircle.setAttribute('stroke-width', '2');
             dynamicElements.appendChild(sunsetCircle);
             
             // æ—¥è½æ ‡ç­¾
             const sunsetText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
             sunsetText.setAttribute('x', sunsetPos.x);
             sunsetText.setAttribute('y', sunsetPos.y - 15);
             sunsetText.setAttribute('text-anchor', 'middle');
             sunsetText.setAttribute('font-family', 'Arial');
             sunsetText.setAttribute('font-size', '11');
             sunsetText.setAttribute('fill', '#333');
             sunsetText.setAttribute('font-weight', 'bold');
             sunsetText.textContent = `æ—¥è½ ${formatTimeLabel(sunset)}`;
             dynamicElements.appendChild(sunsetText);
             
             // ç»˜åˆ¶æœˆå‡ºç‚¹
             const moonrisePos = calculatePosition(moonrise);
             if (moonrisePos.y < 200) {
                 const moonriseCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                 moonriseCircle.setAttribute('cx', moonrisePos.x);
                 moonriseCircle.setAttribute('cy', moonrisePos.y);
                 moonriseCircle.setAttribute('r', '5');
                 moonriseCircle.setAttribute('fill', '#C0C0C0');
                 moonriseCircle.setAttribute('stroke', '#A0A0A0');
                 moonriseCircle.setAttribute('stroke-width', '2');
                 dynamicElements.appendChild(moonriseCircle);
                 
                 // æœˆå‡ºæ ‡ç­¾
                 const moonriseText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                 moonriseText.setAttribute('x', moonrisePos.x);
                 moonriseText.setAttribute('y', moonrisePos.y + 20);
                 moonriseText.setAttribute('text-anchor', 'middle');
                 moonriseText.setAttribute('font-family', 'Arial');
                 moonriseText.setAttribute('font-size', '10');
                 moonriseText.setAttribute('fill', '#666');
                 moonriseText.textContent = `æœˆå‡º ${formatTimeLabel(moonrise)}`;
                 dynamicElements.appendChild(moonriseText);
             }
             
             // ç»˜åˆ¶æœˆè½ç‚¹
             const moonsetPos = calculatePosition(moonset);
             if (moonsetPos.y < 200) {
                 const moonsetCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                 moonsetCircle.setAttribute('cx', moonsetPos.x);
                 moonsetCircle.setAttribute('cy', moonsetPos.y);
                 moonsetCircle.setAttribute('r', '5');
                 moonsetCircle.setAttribute('fill', '#A0A0A0');
                 moonsetCircle.setAttribute('stroke', '#808080');
                 moonsetCircle.setAttribute('stroke-width', '2');
                 dynamicElements.appendChild(moonsetCircle);
                 
                 // æœˆè½æ ‡ç­¾
                 const moonsetText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                 moonsetText.setAttribute('x', moonsetPos.x);
                 moonsetText.setAttribute('y', moonsetPos.y + 20);
                 moonsetText.setAttribute('text-anchor', 'middle');
                 moonsetText.setAttribute('font-family', 'Arial');
                 moonsetText.setAttribute('font-size', '10');
                 moonsetText.setAttribute('fill', '#666');
                 moonsetText.textContent = `æœˆè½ ${formatTimeLabel(moonset)}`;
                 dynamicElements.appendChild(moonsetText);
             }
             
             // ç»˜åˆ¶å½“å‰å¤ªé˜³ä½ç½®ï¼ˆå¦‚æœåœ¨ç™½å¤©ï¼‰
             if (currentHour >= sunrise && currentHour <= sunset) {
                 const currentPos = calculatePosition(currentHour);
                 const currentSun = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                 currentSun.setAttribute('cx', currentPos.x);
                 currentSun.setAttribute('cy', currentPos.y);
                 currentSun.setAttribute('r', '10');
                 currentSun.setAttribute('fill', '#FFD700');
                 currentSun.setAttribute('stroke', '#FFA500');
                 currentSun.setAttribute('stroke-width', '3');
                 currentSun.setAttribute('opacity', '0.9');
                 dynamicElements.appendChild(currentSun);
                 
                 // å¤ªé˜³å…‰èŠ’æ•ˆæœ
                 for (let i = 0; i < 8; i++) {
                     const angle = (i * 45) * Math.PI / 180;
                     const rayLength = 15;
                     const x1 = currentPos.x + Math.cos(angle) * 12;
                     const y1 = currentPos.y + Math.sin(angle) * 12;
                     const x2 = currentPos.x + Math.cos(angle) * (12 + rayLength);
                     const y2 = currentPos.y + Math.sin(angle) * (12 + rayLength);
                     
                     const ray = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                     ray.setAttribute('x1', x1);
                     ray.setAttribute('y1', y1);
                     ray.setAttribute('x2', x2);
                     ray.setAttribute('y2', y2);
                     ray.setAttribute('stroke', '#FFD700');
                     ray.setAttribute('stroke-width', '2');
                     ray.setAttribute('opacity', '0.6');
                     dynamicElements.appendChild(ray);
                 }
                 
                 // å½“å‰æ—¶é—´æ ‡ç­¾
                 const currentText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                 currentText.setAttribute('x', currentPos.x);
                 currentText.setAttribute('y', currentPos.y + 35);
                 currentText.setAttribute('text-anchor', 'middle');
                 currentText.setAttribute('font-family', 'Arial');
                 currentText.setAttribute('font-size', '12');
                 currentText.setAttribute('font-weight', 'bold');
                 currentText.setAttribute('fill', '#FF6B35');
                 currentText.textContent = `å½“å‰ ${formatTimeLabel(currentHour)}`;
                 dynamicElements.appendChild(currentText);
             }
             
             // ç»˜åˆ¶å½“å‰æœˆäº®ä½ç½®ï¼ˆå¦‚æœåœ¨å¤œé—´ä¸”æœˆäº®å¯è§ï¼‰
             const isMoonVisible = (currentHour >= moonrise && moonrise < moonset) || (currentHour <= moonset && moonrise > moonset);
             if (isMoonVisible) {
                 const moonCurrentPos = calculatePosition(currentHour + 12); // ç®€åŒ–è®¡ç®—
                 if (moonCurrentPos.y < 200) { // åªåœ¨åœ°å¹³çº¿ä¸Šæ–¹æ˜¾ç¤º
                     const moon = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                     moon.setAttribute('cx', moonCurrentPos.x);
                     moon.setAttribute('cy', moonCurrentPos.y);
                     moon.setAttribute('r', '8');
                     moon.setAttribute('fill', '#C0C0C0');
                     moon.setAttribute('stroke', '#A0A0A0');
                     moon.setAttribute('stroke-width', '2');
                     moon.setAttribute('opacity', '0.8');
                     dynamicElements.appendChild(moon);
                     
                     // æœˆäº®å½“å‰ä½ç½®æ ‡ç­¾
                     const moonCurrentText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                     moonCurrentText.setAttribute('x', moonCurrentPos.x);
                     moonCurrentText.setAttribute('y', moonCurrentPos.y + 35);
                     moonCurrentText.setAttribute('text-anchor', 'middle');
                     moonCurrentText.setAttribute('font-family', 'Arial');
                     moonCurrentText.setAttribute('font-size', '10');
                     moonCurrentText.setAttribute('font-weight', 'bold');
                     moonCurrentText.setAttribute('fill', '#666');
                     moonCurrentText.textContent = 'å½“å‰æœˆäº®';
                     dynamicElements.appendChild(moonCurrentText);
                 }
             }
         }
         

     </script>
</body>
</html>